<!DOCTYPE html>
<html lang="en" dir="ltr" class="no-js">
<head>
    <meta charset="utf-8" />
    <title>Workcraft - help:dfs_plugin</title>
    <script>(function(H){H.className=H.className.replace(/\bno-js\b/,'js')})(document.documentElement)</script>
    <meta name="generator" content="DokuWiki"/>
<meta name="robots" content="index,follow"/>
<meta name="keywords" content="help,dfs plugin"/>
<link rel="search" type="application/opensearchdescription+xml" href="lib/exe/opensearch.html" title="Workcraft"/>
<link rel="start" href="dfs_plugin.html"/>
<link rel="contents" href="dfs_plugin.html" title="Sitemap"/>
<link rel="alternate" type="application/rss+xml" title="Changes" />
<link rel="alternate" type="application/rss+xml" title="Current namespace" />
<link rel="edit" title="Edit this page" href="dfs_plugin.html"/>
<link rel="alternate" type="text/html" title="Plain HTML" href="_export/xhtml/help/dfs_plugin.xhtml"/>
<link rel="alternate" type="text/plain" title="Wiki Markup" href="_export/raw/help/dfs_plugin.raw"/>
<link rel="canonical" href="http://www.workcraft.org/help/dfs_plugin"/>
<link rel="stylesheet" type="text/css" href="lib/exe/css.php.t.dokuwiki-light-export.css"/>
<script type="text/javascript">/*<![CDATA[*/var NS='help';var SIG=' --- //[[danilovesky@gmail.com|Danil Sokolov]] 2015/10/31 20:23//';var JSINFO = {"id":"help:dfs_plugin","namespace":"help","plugin_folded":{"hide":"hide","reveal":"reveal"}};
/*!]]>*/</script>
<script type="text/javascript" charset="utf-8" src="lib/exe/js.php.t.dokuwiki-light-export.js"></script>
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <link rel="shortcut icon" href="favicon.ico" />
<link rel="apple-touch-icon" href="apple-touch-icon.png" />
    </head>

<body>
    <!--[if lte IE 7 ]><div id="IE7"><![endif]--><!--[if IE 8 ]><div id="IE8"><![endif]-->
    <div id="dokuwiki__site"><div id="dokuwiki__top" class="site dokuwiki mode_show tpl_dokuwiki-light-export loggedIn    ">

        
<!-- ********** HEADER ********** -->
<div id="dokuwiki__header"><div class="pad group">

        <h1><a href="start.html"  title="Workcraft start page"><img src="logo.png" width="327" height="57" alt="" /></a></h1>
    <br><br><br><br>
    <div class="tools group">
        <!-- USER TOOLS -->
<!--
                    <div id="dokuwiki__usertools">
                <h3 class="a11y">User Tools</h3>
                <ul>
                    <li><a href="dfs_plugin.html"  class="action admin" rel="nofollow" title="Admin">Admin</a></li><li><a href="dfs_plugin.html"  class="action profile" rel="nofollow" title="Profile">Profile</a></li><li><a href="dfs_plugin.html"  class="action logout" rel="nofollow" title="Logout">Logout</a></li>                </ul>
            </div>
        -->

        <!-- SEARCH TOOLS -->
<!--
        <div id="dokuwiki__searchtools">
            <h3 class="a11y"></h3>
            <form action="start.html" accept-charset="utf-8" class="search" id="dw__search" method="get" role="search"><div class="no"><input type="hidden" name="do" value="search" /><input type="text" id="qsearch__in" accesskey="f" name="id" class="edit" title="[F]" /><input type="submit" value="Search" class="button" title="Search" /><div id="qsearch__out" class="ajax_qsearch JSpopup"></div></div></form>        </div>
-->

        <!-- SITE TOOLS -->
<!--
        <div id="dokuwiki__sitetools">
            <h3 class="a11y">Site Tools</h3>
                            <div class="mobileTools">
                    <form action="/doku.html.doku.php.html" method="get" accept-charset="utf-8"><div class="no"><input type="hidden" name="id" value="help:dfs_plugin" /><input type="hidden" name="sectok" value="5429c19a4b6d7edfd9b8f9d17ffd6cb3" /><select name="do" class="edit quickselect" title="Tools"><option value="">Tools</option><optgroup label="Page Tools"><option value="edit">Edit this page</option><option value="revisions">Old revisions</option><option value="backlink">Backlinks</option></optgroup><optgroup label="Site Tools"><option value="recent">Changes</option><option value="media">Manager</option><option value="index">Sitemap</option></optgroup><optgroup label="User Tools"><option value="logout">Logout</option><option value="profile">Profile</option><option value="admin">Admin</option></optgroup></select><input type="submit" value="&gt;" /></div></form>                </div>
                <ul>
                    <li><a href="dfs_plugin.html"  class="action recent" accesskey="r" rel="nofollow" title="Changes [R]">Changes</a></li><li><a href="dfs_plugin.html"  class="action media" rel="nofollow" title="Manager">Manager</a></li><li><a href="dfs_plugin.html"  class="action index" accesskey="x" rel="nofollow" title="Sitemap [X]">Sitemap</a></li>                </ul>
                    </div>
    </div>
-->

    <!-- BREADCRUMBS -->
        
    <hr class="a11y" />
</div></div><!-- /header -->

        <div class="wrapper group">

            
            <!-- ********** CONTENT ********** -->
            <div id="dokuwiki__content"><div class="pad group">
                <div class="pageId"><span>help:dfs_plugin</span></div>
                <div class="page group">
                                                            <!-- wikipage start -->
                    <!-- TOC START -->
<div id="dw__toc">
<h3 class="toggle">Table of Contents</h3>
<div>

<ul class="toc">
<li class="level1"><div class="li"><a href="#capturing">Capturing</a></div>
<ul class="toc">
<li class="level2"><div class="li"><a href="#components">Components</a></div></li>
<li class="level2"><div class="li"><a href="#connections">Connections</a></div></li>
</ul>
</li>
<li class="level1"><div class="li"><a href="#editing">Editing</a></div></li>
<li class="level1"><div class="li"><a href="#cycle_analysis">Cycle analysis</a></div></li>
<li class="level1"><div class="li"><a href="#simulation">Simulation</a></div></li>
<li class="level1"><div class="li"><a href="#verification">Verification</a></div></li>
</ul>
</div>
</div>
<!-- TOC END -->

<h1 id="dataflow_structure_plugin">Dataflow Structure plugin</h1>
<div class="level1">
<div class="wrap_tip plugin_wrap">
<p>
Familiarise yourself with <a href="toc_generic.html" class="wikilink1" title="help:toc_generic">Workcraft interface</a> to learn its common features that are available for all plugins.
</p>
</div>
<p>
This plugin is intended for capturing, simulation and verification of Dataflow Structure (DFS) models. It supports <em>Static</em> and <em>Dynamic</em> aspects of this model and also <em>spread token</em> and <em>counterflow</em> execution semantics. For simulation and verification a DFS model is automatically translated into a Signal Transition Graph (STG) that allows re-using the features of the <a href="stg_plugin.html" class="wikilink1" title="help:stg_plugin">STG plugin</a>.
</p>

</div>

<h2 id="capturing">Capturing</h2>
<div class="level2">

<p>
In order to create a DFS model choose <em>File→Create work…</em> menu item. In the <em>New work</em> dialogue box select <em>Dataflow Structure</em> as the model type. You may also want to give the work a meaningful name, e.g. <em>dfs-test1</em>, otherwise it will be created as <em>Untitled</em> work. Click <em>OK</em> or press <kbd>Enter</kbd> to create the work.
</p>

<p>
<img src="new_work-dfs.png" class="mediacenter" title="New work of Dataflow Structure type" alt="New work of Dataflow Structure type" />
</p>

</div>

<h3 id="components">Components</h3>
<div class="level3">

<p>
Dataflow Structures plugin supports 3 families of components:
</p>
<ul>
<li class="level1"><div class="li">
 Static components (logic and registers).
</div></li>
<li class="level1"><div class="li">
 Dynamic components (control, push and pop registers).
</div></li>
<li class="level1"><div class="li">
 Counterflow components (logic and registers).
</div></li>
</ul>


<p>
Select the corresponding generator tool to create components of a needed type.
</p>

</div>

<h4 id="static_components">Static components</h4>
<div class="level4">

<p>
The following terminology is used to describe the execution semantics of DFS model:
</p>
<ul>
<li class="level1"><div class="li">
 A register component is <em>marked</em> if it has a token and a register is <em>empty</em> if it does not have a token.
</div></li>
<li class="level1"><div class="li">
 A logic component is <em>reset</em> if it has not evaluated its function yet and a logic component is <em>computed</em> if it has evaluated the function.
</div></li>
<li class="level1"><div class="li">
 <em>Preset</em> (<em>postset</em>) of a component is a set of components that are directly connected by its incoming (outgoing) arcs.
</div></li>
<li class="level1"><div class="li">
 <em>R-preset</em> (<em>R-postset</em>) of a component is a set of registers in its preset/postset, transitive through logic components.
</div></li>
</ul>

<ul>
<li class="level1"><div class="li">
 <img src="editor_tools-dfs-logic.png" class="media" title="[L] Logic" alt="[L] Logic" /> – <strong>logic generator</strong>  – for modelling combinational logic of dataflow pipelines. The logic evaluation rules are as follows:
</div><ul>
<li class="level2"><div class="li">
 A reset logic can compute if the following conditions are met:
</div><ul>
<li class="level3"><div class="li">
 all logic components in its preset are computed;
</div></li>
<li class="level3"><div class="li">
 all registers in its preset are marked.
</div></li>
</ul>
</li>
<li class="level2"><div class="li">
 A computed logic can reset if the following conditions are met:
</div><ul>
<li class="level3"><div class="li">
 all logic components in its preset are reset;
</div></li>
<li class="level3"><div class="li">
 all registers in its preset are empty.
</div></li>
</ul>
</li>
</ul>
</li>
</ul>

<ul>
<li class="level1"><div class="li">
 <img src="editor_tools-dfs-register.png" class="media" title="[R] Register" alt="[R] Register" /> – <strong>register generator</strong> – for modelling sequential elements of dataflow pipelines and data propagations as abstract tokens. The token propagation rules are as follows:
</div><ul>
<li class="level2"><div class="li">
 A token can propagate to an empty register if the following conditions are met: 
</div><ul>
<li class="level3"><div class="li">
 all logic components in its preset are computed;
</div></li>
<li class="level3"><div class="li">
 all registers in its R-preset are marked;
</div></li>
<li class="level3"><div class="li">
 all registers in its R-postset are empty.
</div></li>
</ul>
</li>
<li class="level2"><div class="li">
 A token can leave a marked register if the following conditions are met:
</div><ul>
<li class="level3"><div class="li">
 all logic components in its preset are reset;
</div></li>
<li class="level3"><div class="li">
 all registers in its R-preset are empty;
</div></li>
<li class="level3"><div class="li">
 all registers in its R-postset are marked.
</div></li>
</ul>
</li>
</ul>
</li>
</ul>


<p>
The above rules of token propagation define a so-called <em>spread token</em> execution semantics. A token can occupy several adjacent registers: its <em>head</em> expands to the succeeding registers, while its <em>tail</em> catches up.
</p>

<p>
Note that logic components can model <em>Early evaluation</em> – see the corresponding entry in the <em>Property editor</em>. An early evaluating logic component is denoted by <code>EE</code> label and its evaluation rules change as follows:
</p>
<ul>
<li class="level1"><div class="li">
 A reset early evaluating logic can compute if any logic components in its preset is computed or any register in its preset is marked.
</div></li>
<li class="level1"><div class="li">
 A computed early evaluating logic can reset if any logic component in its preset is reset or any register in its preset is empty.
</div></li>
</ul>


</div>

<h4 id="dynamic_components">Dynamic components</h4>
<div class="level4">

<p>
As the name suggests, dynamic components enable the change of a  Dataflow Structure in run-time, e.g. to selectively include, exclude or reorder the sections of a dataflow pipeline. 
</p>

<p>
In addition to the terminology introduced for the static components, the dynamic components operate with two types of tokens: <em>True</em> or <em>False</em>. We use terms <em>T-marked</em> and <em>F-marked</em> to specify the state of a marked dynamic register. 
</p>
<ul>
<li class="level1"><div class="li">
 <img src="editor_tools-dfs-control.png" class="media" title="[T] Control register" alt="[T] Control register" /> – <strong>control register generator</strong> – this register can hold a <em>True</em> or <em>False</em> token. The spread token execution semantics also applies here. The type of the stored token dynamically controls the propagation of tokens through the connected push and pop registers. The type of token that propagates into the control register depends on its <em>Synchronisation type</em> property (can be used to perform Boolean operation on the True and False tokens):
</div><ul>
<li class="level2"><div class="li">
 <strong>plain</strong> - the control register behaves similar to a C-element:
</div><ul>
<li class="level3"><div class="li">
 if all incoming tokens are False, then the resultant token is also False;
</div></li>
<li class="level3"><div class="li">
 if all incoming tokens are True, then the resultant token is also True;
</div></li>
<li class="level3"><div class="li">
 if there is a mismatch among the types of incoming tokens, then the control register cannot accept a new token.
</div></li>
</ul>
</li>
<li class="level2"><div class="li">
 <strong>and</strong> - the control register behaves as an AND-gate:
</div><ul>
<li class="level3"><div class="li">
 if all incoming tokens are True, then the resultant token is True;
</div></li>
<li class="level3"><div class="li">
 otherwise the resultant token is False.
</div></li>
</ul>
</li>
<li class="level2"><div class="li">
 <strong>or</strong> - the control register behaves as an OR-gate:
</div><ul>
<li class="level3"><div class="li">
 if all incoming tokens are False, then the resultant token is False;
</div></li>
<li class="level3"><div class="li">
 otherwise the resultant token is true.
</div></li>
</ul>
</li>
</ul>
</li>
</ul>

<ul>
<li class="level1"><div class="li"> <img src="editor_tools-dfs-push.png" class="media" title="[U] Push register" alt="[U] Push register" /> – <strong>push register generator</strong> – this register can behave in two different ways depending on the token type in the attached control register:</div>
<ul>
<li class="level3"><div class="li"> If the attached control register is T-marked then the push register behaves as a standard register, i.e. propagates tokens from its R-preset to its R-postset.</div>
</li>
<li class="level3"><div class="li"> If the attached control register is F-marked, then the next token that enters into the push register becomes False and does not propagate further (the token gets <em>consumed</em> by the push register).</div>
</li>
</ul>
</li>
</ul>
<ul>
<li class="level1"><div class="li"> <img src="editor_tools-dfs-pop.png" class="media" title="[O] Pop register" alt="[O] Pop register" /> – <strong>pop register generator</strong> – this register can behave in two different ways depending on the token type in the attached control register:</div>
<ul>
<li class="level3"><div class="li"> If the attached control register is T-marked then the pop register behaves as a standard register, i.e. propagates tokens from its R-preset to its R-postset.</div>
</li>
<li class="level3"><div class="li"> If the attached control register is F-marked, then a False token appears in the pop register (the token is <em>produced</em> by the pop register).</div>
</li>
</ul>
</li>
</ul>

<p>
In a control register True and False tokens are depicted as empty circles with “T” and “F” symbols respectively. In the push and pop registers True tokens are depicted as filled circles (the same as for static registers), while False tokens are depicted as empty circles.
</p>

</div>

<h4 id="counterflow_components">Counterflow components</h4>
<div class="level4">

<p>
The counterflow components are introduced to enable forward and backward flow of tokens. The forward flow is similar to the token propagation in standard static components, while the backward flow of tokens is used to inform the preceding components that their output is no longer needed. This so-called <em>counterflow</em> execution semantics is useful to model preemption and speculative execution.
</p>
<ul>
<li class="level1"><div class="li">
 <img src="editor_tools-dfs-counterflow_logic.png" class="media" title="[K] Counterflow logic" alt="[K] Counterflow logic" /> – <strong>counterflow logic generator</strong>
</div></li>
</ul>

<ul>
<li class="level1"><div class="li"> <img src="editor_tools-dfs-counterflow_register.png" class="media" title="[Q] Counterflow register" alt="[Q] Counterflow register" /> – <strong>counterflow register generator</strong></div>
</li>
</ul>

<p>
 The details of counterflow execution are too complex for this document and can be found elsewhere <a href="#refnotes:1:note1" name="refnotes:1:ref1" class="refnotes-ref note-popup">[1]</a>. Note that counterflow components are intended for experienced DFS users.
</p>

</div>

<h3 id="connections">Connections</h3>
<div class="level3">

<p>
When the connection tool <img src="editor_tools-connect.png" class="media" title="[C] Connect" alt="[C] Connect" /> is active you can connect DFS components. Several connections may start at the same component and a component can have several incoming connections. If an incorrect connection is attempted (e.g. a connection from a dynamic component to a counterflow component) then a warning message will be issued.
</p>

<p>
<img src="dfs-capturing.png" class="mediacenter" title="Capturing DFS model with static and dynamic components" alt="Capturing DFS model with static and dynamic components" />
</p>

<p>
Note that the type of token received by a control register can be inverted by setting the <em>Inverting</em> property of the corresponding connection (the inversion is depicted as a small bubble at the arrowhead of the connection). This can be used to dynamically include or exclude a portion of a pipeline. In the above example the control register <code>c0</code> dynamically decides which branch of the pipeline is exercised: <code>p0→l6→r3→l7→p1</code> or <code>p2→l1→p3</code>.
</p>

</div>

<h2 id="editing">Editing</h2>
<div class="level2">

<p>
For model editing, activate the selection tool <img src="editor_tools-select.png" class="media" title="[S] Select" alt="[S] Select" />. All the standard editing features (select, drag-and-drop, delete, copy, undo, group, etc.) work the same – see generic help on <a href="tool_controls_panel.html#selection_controls" class="wikilink1" title="help:tool_controls_panel">Selection controls</a> and <a href="property_editor_panel.html" class="wikilink1" title="help:property_editor_panel">Property editor</a> for details. 
</p>

<p>
Similar to all the other models, textual comments can be created by activating the <img src="editor_tools-text_note.png" class="media" title="[N] Text Note" alt="[N] Text Note" /> tool and clicking the editor panel in the position you want to put the text. Double-click on the note box to edit its text label in-place or do it through the property editor panel when the note is selected.
</p>

</div>

<h2 id="cycle_analysis">Cycle analysis</h2>
<div class="level2">

<p>
All the components can be associated with a <em>Delay</em> value in the <em>Property editor</em> (zero by default) that can be utilised for performance analysis of the Dataflow Structures. For this activate the cycle analyser tool <img src="editor_tools-cycle_analysis.png" class="media" title="[A] Cycle analyser" alt="[A] Cycle analyser" /> – several slowest cycles (10 by default) will be enumerated in the <em>Tool controls</em> panel and the slowest nodes of the whole DFS graph will be highlighted in red. Selecting a cycle in the <em>Tools control</em> highlights it on the DFS graph and the slowest components of that cycle are also highlighted in red.
</p>

<p>
<img src="dfs-cycle_analysis.png" class="mediacenter" title="Cycle analysis" alt="Cycle analysis" />
</p>

</div>

<h2 id="simulation">Simulation</h2>
<div class="level2">

<p>
For simulation of a DFS model activate the simulation tool <img src="editor_tools-simulate.png" class="media" title="[M] Simulate" alt="[M] Simulate" />. The enabled components are highlighted and can be executed by clicking them. The simulation tool controls provide the means for analysis and navigation through the simulation trace, see generic help on <a href="tool_controls_panel.html#simulation_controls" class="wikilink1" title="help:tool_controls_panel">Simulation controls</a> for details.
</p>

<p>
<img src="dfs-simulation.png" class="mediacenter" title="Simulation" alt="Simulation" />
</p>

<p>
Note that simulation of a DFS model is just an abstraction over the simulation of an automatically generated STG representation of the DFS components.
</p>

</div>

<h2 id="verification">Verification</h2>
<div class="level2">

<p>
Verification of a DFS model done via translation into an STG model and formulation of verification tasks in terms of the obtained STF. A DFS can be checked for deadlocks and hazards by choosing a corresponding item from <em>Verification</em> menu:
</p>
<ul>
<li class="level1"><div class="li">
 <em>Deadlock [MPSat]</em> - verify if the DFS model is deadlock-free.
</div></li>
<li class="level1"><div class="li">
 <em>Hazard [MPSat]</em> - verify if the DFS model is hazard-free.
</div></li>
<li class="level1"><div class="li">
 <em>Deadlock and hazard (reuse unfolding) [MPSat]</em> - verify if the DFS model is free from deadlocks and hazards.
</div></li>
</ul>


<p>
For example, if the inverting property of some arcs is set incorrectly (notice that we intentionally swapped the arcs highlighted in blue), then verification reveals the reachability of a deadlock state. The verification tool reports a trace (or a several traces) leading to the problematic state. A reported trace can be simulated (by pressing the <em>Play</em> button next to the trace) to better understand the causes of the problem.
</p>

<p>
<img src="dfs-verification-deadlock.png" class="mediacenter" title="Detection of a deadlock" alt="Detection of a deadlock" />
</p>



</div>
<div class="refnotes">
<hr>
<div class="notes">
<div class="note left">
<b><a name="refnotes:1:note1" class="nolink">[1]</a></b>
<span id="refnotes:1:note1:text">
D. Sokolov, I. Poliakov, A. Yakovlev: <em>“Analysis of static data flow structures”</em>, Fundamenta Informaticae, vol. 88(4), pp. 581–610, 2008.
</span></div>
</div>
</div>

                    <!-- wikipage stop -->
                                    </div>
<!--
                                    <div class="docInfo"><bdi>help/dfs_plugin.txt</bdi> · Last modified: 2015/10/16 11:05 by <bdi>danil</bdi></div>
                -->
                            </div></div><!-- /content -->

            <hr class="a11y" />

            <!-- PAGE ACTIONS -->
<!--
            <div id="dokuwiki__pagetools">
                            <h3 class="a11y">Page Tools</h3>
                <div class="tools">
                    <ul>
                        <li><a href="dfs_plugin.html"  class="action edit" accesskey="e" rel="nofollow" title="Edit this page [E]"><span>Edit this page</span></a></li><li><a href="dfs_plugin.html"  class="action revs" accesskey="o" rel="nofollow" title="Old revisions [O]"><span>Old revisions</span></a></li><li><a href="dfs_plugin.html"  class="action backlink" rel="nofollow" title="Backlinks"><span>Backlinks</span></a></li><li><a href="#dokuwiki__top"  class="action top" accesskey="t" rel="nofollow" title="Back to top [T]"><span>Back to top</span></a></li><li><a href="dfs_plugin.html"  class="action export_pdf" rel="nofollow" title="Export to PDF"><span>Export to PDF</span></a></li><li><a href="dfs_plugin.html"  class="action siteexport_addpage" title="Add page"><span>Export Page</span></a></li>                    </ul>
                </div>
                        </div>
-->
        </div><!-- /wrapper -->

        
<!-- ********** FOOTER ********** -->
<div id="dokuwiki__footer"><div class="pad">
    <!--
    <div class="buttons">
                <a href="http://www.dokuwiki.org/donate" title="Donate" ><img
            src="lib/tpl/dokuwiki-light-export/images/button-donate.gif" width="80" height="15" alt="Donate" /></a>
        <a href="http://www.php.net" title="Powered by PHP" ><img
            src="lib/tpl/dokuwiki-light-export/images/button-php.gif" width="80" height="15" alt="Powered by PHP" /></a>
        <a href="http://validator.w3.org/check/referer" title="Valid HTML5" ><img
            src="lib/tpl/dokuwiki-light-export/images/button-html5.png" width="80" height="15" alt="Valid HTML5" /></a>
        <a href="http://jigsaw.w3.org/css-validator/check/referer?profile=css3" title="Valid CSS" ><img
            src="lib/tpl/dokuwiki-light-export/images/button-css.png" width="80" height="15" alt="Valid CSS" /></a>
        <a href="http://dokuwiki.org/" title="Driven by DokuWiki" ><img
            src="lib/tpl/dokuwiki-light-export/images/button-dw.png" width="80" height="15" alt="Driven by DokuWiki" /></a>
    </div>
-->

<!--
    <div class="userInfo">
        Logged in as:: danil    </div>
-->
</div></div><!-- /footer -->

    </div></div><!-- /site -->

    <div class="no"><img  width="2" height="1" alt="" /></div>
    <div id="screen__mode" class="no"></div>    <!--[if ( lte IE 7 | IE 8 ) ]></div><![endif]-->
</body>
</html>

