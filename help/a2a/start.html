<!DOCTYPE html>
<html lang="en" dir="ltr" class="no-js">
<head>
    <meta charset="utf-8" />
    <title>help:a2a:start - Workcraft</title>
    <script>(function(H){H.className=H.className.replace(/\bno-js\b/,'js')})(document.documentElement)</script>
    <meta name="generator" content="DokuWiki"/>
<meta name="robots" content="index,follow"/>
<meta name="keywords" content="help,a2a,start"/>
<link rel="search" type="application/opensearchdescription+xml" href="../lib/exe/opensearch.html" title="Workcraft"/>
<link rel="start" href="start.html"/>
<link rel="contents" href="start.html" title="Sitemap"/>
<link rel="alternate" type="application/rss+xml" title="Changes" />
<link rel="alternate" type="application/rss+xml" title="Current namespace" />
<link rel="edit" title="Edit this page" href="start.html"/>
<link rel="alternate" type="text/html" title="Plain HTML" href="../_export/xhtml/help/a2a/start.xhtml"/>
<link rel="alternate" type="text/plain" title="Wiki Markup" href="../_export/raw/help/a2a/start.raw"/>
<link rel="canonical" href="https://workcraft.org/help/a2a/start"/>
<link rel="stylesheet" type="text/css" href="../lib/exe/css.php.t.dokuwiki-light-export.css"/>
<!--[if gte IE 9]><!-->
<script type="text/javascript">/*<![CDATA[*/var NS='help:a2a';var SIG=' --- //[[support@workcraft.org| ]] 2020/06/16 09:40//';var JSINFO = {"id":"help:a2a:start","namespace":"help:a2a","fastwiki":{"secedit":1,"preview":1,"fastpages":1,"save":0,"fastshow":0,"fastshow_same_ns":1,"fastshow_include":"","fastshow_exclude":"","preload":false,"preload_head":"====47hsjwycv782nwncv8b920m8bv72jmdm3929bno3b3====","preload_batchsize":false,"preload_per_page":false,"locktime":840,"usedraft":1,"text_btn_show":"Show page","templatename":"dokuwiki-light-export"},"move_renameokay":true,"plugin_folded":{"hide":"hide","reveal":"reveal"}};
/*!]]>*/</script>
<script type="text/javascript" charset="utf-8" src="../lib/exe/jquery.php.t.dokuwiki-light-export.js"></script>
<script type="text/javascript" charset="utf-8" src="../lib/exe/js.php.t.dokuwiki-light-export.js"></script>
<!--<![endif]-->
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <link rel="shortcut icon" href="../favicon.ico" />
<link rel="apple-touch-icon" href="../apple-touch-icon.png" />
    </head>

<body>
    <div id="dokuwiki__site"><div id="dokuwiki__top" class="site dokuwiki mode_show tpl_dokuwiki-light-export loggedIn    ">

        
<!-- ********** HEADER ********** -->
<div id="dokuwiki__header"><div class="pad group">

        <h1><a href="../start.html"  title="Workcraft start page"><img src="../logo.png" width="327" height="57" alt="" /></a></h1>
    
    <div class="tools group">
        <!-- USER TOOLS -->
<!--
                    <div id="dokuwiki__usertools">
                <h3 class="a11y">User Tools</h3>
                <ul>
                    <li><a href="start.html"  class="action admin" rel="nofollow" title="Admin">Admin</a></li><li><a href="start.html"  class="action profile" rel="nofollow" title="Profile">Profile</a></li><li><a href="start.html"  class="action logout" rel="nofollow" title="Log Out">Log Out</a></li>                </ul>
            </div>
        -->

        <!-- SEARCH TOOLS -->
<!--
        <div id="dokuwiki__searchtools">
            <h3 class="a11y"></h3>
            <form action="../start.html" accept-charset="utf-8" class="search" id="dw__search" method="get" role="search"><div class="no"><input type="hidden" name="do" value="search" /><input type="text" placeholder="Search" id="qsearch__in" accesskey="f" name="id" class="edit" title="[F]" /><button type="submit" title="Search">Search</button><div id="qsearch__out" class="ajax_qsearch JSpopup"></div></div></form>        </div>
-->

        <!-- SITE TOOLS -->
<!--
        <div id="dokuwiki__sitetools">
            <h3 class="a11y">Site Tools</h3>
                            <div class="mobileTools">
                    <form action="..//doku.html.doku.php.html" method="get" accept-charset="utf-8"><div class="no"><input type="hidden" name="id" value="help:a2a:start" /><input type="hidden" name="sectok" value="692a2e04d100b7a65a3891149a1d7e4a" /><select name="do" class="edit quickselect" title="Tools"><option value="">Tools</option><optgroup label="Page Tools"><option value="edit">Edit this page</option><option value="revisions">Old revisions</option><option value="backlink">Backlinks</option></optgroup><optgroup label="Site Tools"><option value="recent">Changes</option><option value="media">Manager</option><option value="index">Sitemap</option></optgroup><optgroup label="User Tools"><option value="logout">Log Out</option><option value="profile">Profile</option><option value="admin">Admin</option></optgroup></select><button type="submit">&gt;</button></div></form>                </div>
                <ul>
                    <li><a href="start.html"  class="action recent" accesskey="r" rel="nofollow" title="Changes [R]">Changes</a></li><li><a href="start.html"  class="action media" rel="nofollow" title="Manager">Manager</a></li><li><a href="start.html"  class="action index" accesskey="x" rel="nofollow" title="Sitemap [X]">Sitemap</a></li>                </ul>
                    </div>
-->
    </div>

    <!-- BREADCRUMBS -->
<!--
    -->



    <hr class="a11y" />
</div></div><!-- /header -->

        <div class="wrapper group">

            
            <!-- ********** CONTENT ********** -->
            <div id="dokuwiki__content"><div class="pad group">
                
                <div class="pageId"><span>help:a2a:start</span></div>

                <div class="page group">
                                                            <!-- wikipage start -->
                    <div class="plugin_fastwiki_marker" style="display:none"></div><!-- TOC START -->
<div id="dw__toc">
<h3 class="toggle">Table of Contents</h3>
<div>

<ul class="toc">
<li class="level1"><div class="li"><a href="#synchronisation_primitives">Synchronisation primitives</a></div>
<ul class="toc">
<li class="level2"><div class="li"><a href="#wait_and_wait0">WAIT and WAIT0</a></div></li>
<li class="level2"><div class="li"><a href="#rwait_and_rwait0">RWAIT and RWAIT0</a></div></li>
<li class="level2"><div class="li"><a href="#wait01_and_wait10">WAIT01 and WAIT10</a></div></li>
<li class="level2"><div class="li"><a href="#wait2">WAIT2</a></div></li>
</ul>
</li>
<li class="level1"><div class="li"><a href="#decision-making_primitives">Decision-making primitives</a></div>
<ul class="toc">
<li class="level2"><div class="li"><a href="#waitx">WAITX</a></div></li>
<li class="level2"><div class="li"><a href="#waitx2">WAITX2</a></div></li>
<li class="level2"><div class="li"><a href="#sample">SAMPLE</a></div></li>
<li class="level2"><div class="li"><a href="#opportunistic_merge">Opportunistic Merge</a></div></li>
</ul></li>
</ul>
</div>
</div>
<!-- TOC END -->
<div class="wrap_hide plugin_wrap">
<p>
This page is created to include <code>a2a</code> page in <code>help</code> namespace for automated export of documentation.
</p>
</div><div class="plugin_include_content plugin_include__a2a:start" id="plugin_include__a2a__start">

<h1 id="analog-to-asynchronous_elements">Analog-to-asynchronous elements</h1>
<div class="level1">

<p>
Analog-to-asynchronous (A2A) elements is a family of asynchronous arbitration primitives designed to increase the resilience and efficiency of the new generation of circuits and systems. This includes primitives for synchronisation and decision-making with an emphasis on interfacing analogue and digital worlds, sampling of non-persistent signals, cross-domain communication, and efficient handling of sensor events.
</p>

</div>

<h2 id="synchronisation_primitives">Synchronisation primitives</h2>
<div class="level2">

<p>
This section covers the primitives for the synchronisation of hazard-free signal transitions in asynchronous circuits with potentially hazardous signals coming from the environment.
</p>

</div>

<h3 id="wait_and_wait0">WAIT and WAIT0</h3>
<div class="level3">

<p>
The WAIT element controls an asynchronous handshake <code><span style='color:red; '>ctrl</span> / <span style='color:blue; '>san</span></code> by a non-persistent input <code><span style='color:red; '>sig</span></code>. According to the WAIT <abbr title="Signal Transition Graph">STG</abbr> below, <code><span style='color:red; '>sig</span></code> is unconstrained and is allowed to switch between <code>0</code> and <code>1</code> values with no regard to the output handshake – this is captured by the loop with signal transitions <code><span style='color:red; '>sig+</span></code> and <code><span style='color:red; '>sig-</span></code>. Initially <code><span style='color:red; '>ctrl</span>=<span style='color:blue; '>san</span>=0</code> and WAIT is in the dormant mode, i.e. its input <code><span style='color:red; '>sig</span></code> is isolated from the output <code><span style='color:blue; '>san</span></code>. By raising <code><span style='color:red; '>ctrl</span></code> input, the element can be switched into the waiting mode, where it stays until <code><span style='color:red; '>sig</span></code> becomes high and stays high for sufficiently long for internal event <code>e</code> to fire. The output <code><span style='color:blue; '>san+</span></code> is then produced and <em>persistently</em> held until WAIT is reset by <code><span style='color:red; '>ctrl-</span></code>. Here and further on, the output <code><span style='color:blue; '>san</span></code> is the `sanitised&#039; (persistent) version of the `dirty&#039; (non-persistent) input <code><span style='color:red; '>sig</span></code>. 
</p>

<p>
Note that an input spike (<code><span style='color:red; '>sig+</span></code> followed by <code><span style='color:red; '>sig-</span></code>) in the waiting mode can be too short for the WAIT element to register it, in which case the spike is ignored and WAIT remains in the waiting mode. The non-persistent behaviour and the associated metastability is fully contained within the element, guaranteeing a clean hazard-free output. This is achieved using the mutual-exclusion <code>MUTEX</code> element <a href="#refnotes:1:note1" name="refnotes:1:ref1" class="refnotes-ref note-popup">[1]</a>. Note that the output of the inverter in the implementation of WAIT is non-persistent, but this non-persistency will never propagate to <code><span style='color:blue; '>san</span></code>.
</p>
<div class="wrap_column wrap_third plugin_wrap"><div class="table sectionedit7"><table class="inline">
	<tr class="row0">
		<td class="col0"><img src="wait-box.circuit.svg" width="114" height="91" class="svgscaleinsert mediacenter" alt="a2a:wait-box.circuit.svg"></td>
	</tr>
	<tr class="row1">
		<td class="col0 centeralign">  WAIT block diagram<br/>
<span class="wrap_download "><a href="wait-box.circuit.work" class="media mediafile mf_work" title="a2a:wait-box.circuit.work (2 KB)">wait-box.circuit.work</a> (2 KiB)</span>  </td>
	</tr>
</table></div>
</div><div class="wrap_column wrap_third plugin_wrap"><div class="table sectionedit10"><table class="inline">
	<tr class="row0">
		<td class="col0"><img src="wait.stg.svg" width="218" height="93" class="svgscaleinsert mediacenter" alt="a2a:wait.stg.svg"></td>
	</tr>
	<tr class="row1">
		<td class="col0 centeralign">  WAIT behaviour (conceptual)<br/>
<span class="wrap_download "><a href="wait.stg.work" class="media mediafile mf_work" title="a2a:wait.stg.work (3 KB)">wait.stg.work</a> (3 KiB)</span>  </td>
	</tr>
</table></div>
</div><div class="wrap_column wrap_third plugin_wrap"><div class="table sectionedit13"><table class="inline">
	<tr class="row0">
		<td class="col0"><img src="wait.circuit.svg" width="210" height="99" class="svgscaleinsert mediacenter" alt="a2a:wait.circuit.svg"></td>
	</tr>
	<tr class="row1">
		<td class="col0 centeralign">  WAIT implementation<br/>
<span class="wrap_download "><a href="wait.circuit.work" class="media mediafile mf_work" title="a2a:wait.circuit.work (2.9 KB)">wait.circuit.work</a> (3 KiB)</span>  </td>
	</tr>
</table></div>
</div>
<p>
The WAIT <abbr title="Signal Transition Graph">STG</abbr> above is not a valid <abbr title="Signal Transition Graph">STG</abbr> specification and should only be viewed as a generator of possible traces: Note that this <abbr title="Signal Transition Graph">STG</abbr> is not <a href="../verification.html#stg_properties" class="wikilink1" title="help:verification">output-determinate</a> <a href="#refnotes:1:note2" name="refnotes:1:ref2" class="refnotes-ref note-popup">[2]</a>, which is an important correctness criterion. That is, there are two different states reachable via the observable trace <code><span style='color:red; '>ctrl+ sig+ sig-</span></code>, with one of them enabling <code><span style='color:blue; '>san+</span></code> and the other not, depending on whether unobservable transition <code>e</code> fired between <code><span style='color:red; '>sig+</span></code> and <code><span style='color:red; '>sig-</span></code>. Hence, if viewed as a contract between the circuit and its environment, this <abbr title="Signal Transition Graph">STG</abbr> is self-contradictory: It simultaneously requires the circuit to produce <code><span style='color:blue; '>san+</span></code> after trace <code><span style='color:red; '>ctrl+ sig+ sig-</span></code>, and forbids it to do so. However, in this particular case the contradiction is resolved by making output <code><span style='color:blue; '>san+</span></code> <em>optional</em> after this trace, as shown in the state graph below. Note that the semantics of STGs is defined so that an enabled output must either fire or be disabled <a href="#refnotes:1:note2" name="refnotes:1:ref3" class="refnotes-ref note-popup">[2]</a>, i.e. outputs are always compulsory (i.e. there is no way to express an optional output in an <abbr title="Signal Transition Graph">STG</abbr>). However, the issue is encapsulated inside WAIT – the environment of WAIT sees <code><span style='color:blue; '>san+</span></code> as an input, and inputs are considered optional in STGs <a href="#refnotes:1:note2" name="refnotes:1:ref4" class="refnotes-ref note-popup">[2]</a>.
</p>
<div class="wrap_center plugin_wrap"><div class="table sectionedit16"><table class="inline">
	<tr class="row0">
		<td class="col0 centeralign">  <img src="sg-wait.svg" width="554" height="238" class="svgscaleinsert mediacenter" alt="a2a:sg-wait.svg">  </td>
	</tr>
	<tr class="row1">
		<td class="col0 centeralign">  WAIT state graph  </td>
	</tr>
</table></div>
</div>
<p>
The symmetric version of the element that waits for the input to become low is called WAIT0; its top-level block diagram, the <abbr title="Signal Transition Graph">STG</abbr> specification and the implementation are as follows:
</p>
<div class="group plugin_wrap"><div class="wrap_column wrap_third plugin_wrap"><div class="table sectionedit21"><table class="inline">
	<tr class="row0">
		<td class="col0"><img src="wait0-box.circuit.svg" width="114" height="91" class="svgscaleinsert mediacenter" alt="a2a:wait0-box.circuit.svg"></td>
	</tr>
	<tr class="row1">
		<td class="col0 centeralign">  WAIT0 block diagram<br/>
<span class="wrap_download "><a href="wait0-box.circuit.work" class="media mediafile mf_work" title="a2a:wait0-box.circuit.work (2 KB)">wait0-box.circuit.work</a> (2 KiB)</span>  </td>
	</tr>
</table></div>
</div><div class="wrap_column wrap_third plugin_wrap"><div class="table sectionedit24"><table class="inline">
	<tr class="row0">
		<td class="col0"><img src="wait0.stg.svg" width="218" height="93" class="svgscaleinsert mediacenter" alt="a2a:wait0.stg.svg"></td>
	</tr>
	<tr class="row1">
		<td class="col0 centeralign">  WAIT0 behaviour (conceptual)<br/>
<span class="wrap_download "><a href="wait0.stg.work" class="media mediafile mf_work" title="a2a:wait0.stg.work (3 KB)">wait0.stg.work</a> (3 KiB)</span>  </td>
	</tr>
</table></div>
</div><div class="wrap_column wrap_third plugin_wrap"><div class="table sectionedit27"><table class="inline">
	<tr class="row0">
		<td class="col0"><img src="wait0.circuit.svg" width="160" height="99" class="svgscaleinsert mediacenter" alt="a2a:wait0.circuit.svg"></td>
	</tr>
	<tr class="row1">
		<td class="col0 centeralign">  WAIT0 implementation<br/>
<span class="wrap_download "><a href="wait0.circuit.work" class="media mediafile mf_work" title="a2a:wait0.circuit.work (2.7 KB)">wait0.circuit.work</a> (3 KiB)</span>  </td>
	</tr>
</table></div>
</div></div>
<p>
WAIT and WAIT0 are fundamental synchronisation primitives which are used for implementing other, more sophisticated elements presented below. 
</p>

</div>

<h3 id="rwait_and_rwait0">RWAIT and RWAIT0</h3>
<div class="level3">

<p>
RWAIT and RWAIT0 are modifications of the WAIT and WAIT0 elements, respectively, with a possibility to persistently cancel the waiting request. This is useful when the input is no longer expected to change or the change is no longer relevant for the asynchronous controller, and hence the output handshake needs to be released.
</p>

<p>
The additional input <code><span style='color:red; '>frc</span></code> can be used to force the reset of the output handshake in the waiting mode. The <abbr title="Signal Transition Graph">STG</abbr> specifies that the output transition <code><span style='color:blue; '>san+</span></code> can be caused either by <code><span style='color:red; '>sig+</span></code> (the top branch) or by <code><span style='color:red; '>frc+</span></code> (the bottom branch). The implementation reflects the resulting <em>OR-causality</em> <a href="#refnotes:1:note3" name="refnotes:1:ref5" class="refnotes-ref note-popup">[3]</a>: the inputs <code><span style='color:red; '>sig</span></code> and <code><span style='color:red; '>frc</span></code> are simply combined via a NOR gate, whose output is synchronised with the handshake <code><span style='color:blue; '>ctrl</span> / <span style='color:red; '>san</span></code> using the WAIT0 element.
</p>
<div class="group plugin_wrap"><div class="wrap_column wrap_half plugin_wrap"><div class="table sectionedit32"><table class="inline">
	<tr class="row0">
		<td class="col0 centeralign">  <img src="rwait-box.circuit.svg" width="126" height="77" class="svgscaleinsert mediacenter" alt="a2a:rwait-box.circuit.svg">  </td>
	</tr>
	<tr class="row1">
		<td class="col0 centeralign">  RWAIT block diagram<br/>
<span class="wrap_download "><a href="rwait-box.circuit.work" class="media mediafile mf_work" title="a2a:rwait-box.circuit.work (2.1 KB)">rwait-box.circuit.work</a> (2 KiB)</span>  </td>
	</tr>
</table></div>
<div class="table sectionedit33"><table class="inline">
	<tr class="row0">
		<td class="col0 centeralign">  <img src="rwait.circuit.svg" width="224" height="87" class="svgscaleinsert mediacenter" alt="a2a:rwait.circuit.svg">  </td>
	</tr>
	<tr class="row1">
		<td class="col0 centeralign">  RWAIT implementation<br/>
<span class="wrap_download "><a href="rwait.circuit.work" class="media mediafile mf_work" title="a2a:rwait.circuit.work (3 KB)">rwait.circuit.work</a> (3 KiB)</span>  </td>
	</tr>
</table></div>
</div><div class="wrap_column wrap_half plugin_wrap"><div class="table sectionedit36"><table class="inline">
	<tr class="row0">
		<td class="col0 centeralign">  <img src="rwait.stg.svg" width="336" height="254" class="svgscaleinsert mediacenter" alt="a2a:rwait.stg.svg">  </td>
	</tr>
	<tr class="row1">
		<td class="col0 centeralign">  RWAIT specification<br/>
<span class="wrap_download "><a href="rwait.stg.work" class="media mediafile mf_work" title="a2a:rwait.stg.work (4.6 KB)">rwait.stg.work</a> (5 KiB)</span>  </td>
	</tr>
</table></div>
</div></div><hr />
<div class="group plugin_wrap"><div class="wrap_column wrap_half plugin_wrap"><div class="table sectionedit41"><table class="inline">
	<tr class="row0">
		<td class="col0 centeralign">  <img src="rwait0-box.circuit.svg" width="136" height="83" class="svgscaleinsert mediacenter" alt="a2a:rwait0-box.circuit.svg">  </td>
	</tr>
	<tr class="row1">
		<td class="col0 centeralign">  RWAIT0 block diagram<br/>
<span class="wrap_download "><a href="rwait0-box.circuit.work" class="media mediafile mf_work" title="a2a:rwait0-box.circuit.work (2.1 KB)">rwait0-box.circuit.work</a> (2 KiB)</span>  </td>
	</tr>
</table></div>
<div class="table sectionedit42"><table class="inline">
	<tr class="row0">
		<td class="col0 centeralign">  <img src="rwait0.circuit.svg" width="229" height="91" class="svgscaleinsert mediacenter" alt="a2a:rwait0.circuit.svg">  </td>
	</tr>
	<tr class="row1">
		<td class="col0 centeralign">  RWAIT0 implementation<br/>
<span class="wrap_download "><a href="rwait0.circuit.work" class="media mediafile mf_work" title="a2a:rwait0.circuit.work (3 KB)">rwait0.circuit.work</a> (3 KiB)</span>  </td>
	</tr>
</table></div>
</div><div class="wrap_column wrap_half plugin_wrap"><div class="table sectionedit45"><table class="inline">
	<tr class="row0">
		<td class="col0 centeralign">  <img src="rwait0.stg.svg" width="336" height="255" class="svgscaleinsert mediacenter" alt="a2a:rwait0.stg.svg">  </td>
	</tr>
	<tr class="row1">
		<td class="col0 centeralign">  RWAIT0 specification<br/>
<span class="wrap_download "><a href="rwait0.stg.work" class="media mediafile mf_work" title="a2a:rwait0.stg.work (4.6 KB)">rwait0.stg.work</a> (5 KiB)</span>  </td>
	</tr>
</table></div>
</div></div>
</div>

<h3 id="wait01_and_wait10">WAIT01 and WAIT10</h3>
<div class="level3">

<p>
WAIT01 and WAIT10 elements wait for a rising or falling edge of the input signal, respectively. Note that this is subtly different from waiting for a high or low input value, e.g. a signal can be initially low, and to generate a falling edge event it must first go high. The WAIT01 specification tracks the input changes via two dummy transitions that are enabled in sequence when <code><span style='color:red; '>sig</span>=0</code> and <code><span style='color:red; '>sig</span>=1</code> hold. This can be implemented by connecting WAIT0 and WAIT in sequence.
</p>
<div class="group plugin_wrap"><div class="wrap_column wrap_third plugin_wrap"><div class="table sectionedit50"><table class="inline">
	<tr class="row0">
		<td class="col0 centeralign">  <img src="wait01-box.circuit.svg" width="114" height="153" class="svgscaleinsert mediacenter" alt="a2a:wait01-box.circuit.svg">  </td>
	</tr>
	<tr class="row1">
		<td class="col0 centeralign">  WAIT01 block diagram<br/>
<span class="wrap_download "><a href="wait01-box.circuit.work" class="media mediafile mf_work" title="a2a:wait01-box.circuit.work (2 KB)">wait01-box.circuit.work</a> (2 KiB)</span>  </td>
	</tr>
</table></div>
</div><div class="wrap_column wrap_third plugin_wrap"><div class="table sectionedit53"><table class="inline">
	<tr class="row0">
		<td class="col0 centeralign">  <img src="wait01.stg.svg" width="172" height="153" class="svgscaleinsert mediacenter" alt="a2a:wait01.stg.svg">  </td>
	</tr>
	<tr class="row1">
		<td class="col0 centeralign">  WAIT01 specification<br/>
<span class="wrap_download "><a href="wait01.stg.work" class="media mediafile mf_work" title="a2a:wait01.stg.work (3.2 KB)">wait01.stg.work</a> (3 KiB)</span>  </td>
	</tr>
</table></div>
</div><div class="wrap_column wrap_third plugin_wrap"><div class="table sectionedit56"><table class="inline">
	<tr class="row0">
		<td class="col0 centeralign">  <img src="wait01.circuit.svg" width="174" height="155" class="svgscaleinsert mediacenter" alt="a2a:wait01.circuit.svg">  </td>
	</tr>
	<tr class="row1">
		<td class="col0 centeralign">  WAIT01 implementation<br/>
<span class="wrap_download "><a href="wait01.circuit.work" class="media mediafile mf_work" title="a2a:wait01.circuit.work (2.8 KB)">wait01.circuit.work</a> (3 KiB)</span>  </td>
	</tr>
</table></div>
</div></div><hr />

<p>
An element waiting for an arbitrary fixed pattern of alternating 0s and 1s, e.g. the symmetric WAIT10 element, can be implemented analogously.
</p>
<div class="group plugin_wrap"><div class="wrap_column wrap_third plugin_wrap"><div class="table sectionedit61"><table class="inline">
	<tr class="row0">
		<td class="col0 centeralign">  <img src="wait10-box.circuit.svg" width="114" height="153" class="svgscaleinsert mediacenter" alt="a2a:wait10-box.circuit.svg">  </td>
	</tr>
	<tr class="row1">
		<td class="col0 centeralign">  WAIT10 block diagram<br/>
<span class="wrap_download "><a href="wait10-box.circuit.work" class="media mediafile mf_work" title="a2a:wait10-box.circuit.work (2 KB)">wait10-box.circuit.work</a> (2 KiB)</span>  </td>
	</tr>
</table></div>
</div><div class="wrap_column wrap_third plugin_wrap"><div class="table sectionedit64"><table class="inline">
	<tr class="row0">
		<td class="col0 centeralign">  <img src="wait10.stg.svg" width="172" height="153" class="svgscaleinsert mediacenter" alt="a2a:wait10.stg.svg">  </td>
	</tr>
	<tr class="row1">
		<td class="col0 centeralign">  WAIT10 specification<br/>
<span class="wrap_download "><a href="wait10.stg.work" class="media mediafile mf_work" title="a2a:wait10.stg.work (3.2 KB)">wait10.stg.work</a> (3 KiB)</span>  </td>
	</tr>
</table></div>
</div><div class="wrap_column wrap_third plugin_wrap"><div class="table sectionedit67"><table class="inline">
	<tr class="row0">
		<td class="col0 centeralign">  <img src="wait10.circuit.svg" width="174" height="148" class="svgscaleinsert mediacenter" alt="a2a:wait10.circuit.svg">  </td>
	</tr>
	<tr class="row1">
		<td class="col0 centeralign">  WAIT10 implementation<br/>
<span class="wrap_download "><a href="wait10.circuit.work" class="media mediafile mf_work" title="a2a:wait10.circuit.work (2.8 KB)">wait10.circuit.work</a> (3 KiB)</span>  </td>
	</tr>
</table></div>
</div></div>
</div>

<h3 id="wait2">WAIT2</h3>
<div class="level3">

<p>
WAIT2 is another combination of WAIT and WAIT0: it uses a <em>2-phase</em> output handshake, waiting for high and low input values, one after the other. One can think of WAIT2 as a <em>2-phase</em> version of the WAIT element, or as a <em>C-element</em> whose input <code><span style='color:red; '>sig</span></code> is hardened against hazards.
</p>

<p>
The <abbr title="Signal Transition Graph">STG</abbr> contains two loops: the inner <code><span style='color:red; '>sig</span></code> loop, which is unconstrained, and the outer handshake loop that synchronises the rising (<code><span style='color:red; '>ctrl+</span>→<span style='color:blue; '>san+</span></code>) and the falling (<code><span style='color:red; '>ctrl-</span>→<span style='color:blue; '>san-</span></code>) phases with conditions <code><span style='color:red; '>sig</span>=1</code> and <code><span style='color:red; '>sig</span>=0</code>, respectively.
</p>

<p>
The implementation uses a toggle-like controller to steer the rising and falling edges of <code><span style='color:red; '>ctrl</span></code> to the inputs of the WAIT and WAIT0 elements, in sequence, and take care of their appropriate reset.
</p>
<div class="group plugin_wrap"><div class="wrap_column wrap_third plugin_wrap"><div class="table sectionedit72"><table class="inline">
	<tr class="row0">
		<td class="col0 centeralign">  <img src="wait2-box.circuit.svg" width="108" height="138" class="svgscaleinsert mediacenter" alt="a2a:wait2-box.circuit.svg">  </td>
	</tr>
	<tr class="row1">
		<td class="col0 centeralign">  WAIT2 block diagram<br/>
<span class="wrap_download "><a href="wait2-box.circuit.work" class="media mediafile mf_work" title="a2a:wait2-box.circuit.work (2 KB)">wait2-box.circuit.work</a> (2 KiB)</span>  </td>
	</tr>
</table></div>
</div><div class="wrap_column wrap_third plugin_wrap"><div class="table sectionedit75"><table class="inline">
	<tr class="row0">
		<td class="col0 centeralign">  <img src="wait2.stg.svg" width="152" height="140" class="svgscaleinsert mediacenter" alt="a2a:wait2.stg.svg">  </td>
	</tr>
	<tr class="row1">
		<td class="col0 centeralign">  WAIT2 specification<br/>
<span class="wrap_download "><a href="wait2.stg.work" class="media mediafile mf_work" title="a2a:wait2.stg.work (3.3 KB)">wait2.stg.work</a> (3 KiB)</span>  </td>
	</tr>
</table></div>
</div><div class="wrap_column wrap_third plugin_wrap"><div class="table sectionedit78"><table class="inline">
	<tr class="row0">
		<td class="col0 centeralign">  <img src="wait2.circuit.svg" width="212" height="139" class="svgscaleinsert mediacenter" alt="a2a:wait2.circuit.svg">  </td>
	</tr>
	<tr class="row1">
		<td class="col0 centeralign">  WAIT2 implementation<br/>
<span class="wrap_download "><a href="wait2.circuit.work" class="media mediafile mf_work" title="a2a:wait2.circuit.work (3.8 KB)">wait2.circuit.work</a> (4 KiB)</span>  </td>
	</tr>
</table></div>
</div></div>
</div>

<h2 id="decision-making_primitives">Decision-making primitives</h2>
<div class="level2">

<p>
This section presents a family of decision-making components that perform non-trivial event coordination and rely on the previously introduced synchronisation primitives.
</p>

</div>

<h3 id="waitx">WAITX</h3>
<div class="level3">

<p>
The WAITX element arbitrates between two non-persistent inputs <code>{<span style='color:red; '>sig1</span>, <span style='color:red; '>sig2</span>}</code>, producing a clean asynchronous dual-rail handshake: depending on which of the two signals arrives first, exactly one of the grant signals <code>{<span style='color:blue; '>g1</span>, <span style='color:blue; '>g2</span>}</code> is issued. The place <code>me</code> with two consuming arcs represents the arbitration decision that needs to be made: if the inputs arrive very close to each other, both of the two dummy transitions can become enabled but only one of them can occur, since <code>me</code> can have at most one token. In the reset phase both branches are merged in the place <code>mrg</code>.
</p>
<div class="group plugin_wrap"><div class="wrap_column wrap_half plugin_wrap"><div class="table sectionedit83"><table class="inline">
	<tr class="row0">
		<td class="col0 centeralign">  <img src="waitx-box.circuit.svg" width="126" height="201" class="svgscaleinsert mediacenter" alt="a2a:waitx-box.circuit.svg">  </td>
	</tr>
	<tr class="row1">
		<td class="col0 centeralign">  WAITX block diagram<br/>
<span class="wrap_download "><a href="waitx-box.circuit.work" class="media mediafile mf_work" title="a2a:waitx-box.circuit.work (2.1 KB)">waitx-box.circuit.work</a> (2 KiB)</span>  </td>
	</tr>
</table></div>
</div><div class="wrap_column wrap_half plugin_wrap"><div class="table sectionedit86"><table class="inline">
	<tr class="row0">
		<td class="col0 centeralign">  <img src="waitx.stg.svg" width="264" height="203" class="svgscaleinsert mediacenter" alt="a2a:waitx.stg.svg">  </td>
	</tr>
	<tr class="row1">
		<td class="col0 centeralign">  WAITX specification<br/>
<span class="wrap_download "><a href="waitx.stg.work" class="media mediafile mf_work" title="a2a:waitx.stg.work (3.8 KB)">waitx.stg.work</a> (4 KiB)</span>  </td>
	</tr>
</table></div>
</div></div><div class="group plugin_wrap"><div class="table sectionedit89"><table class="inline">
	<tr class="row0">
		<td class="col0 centeralign">  <img src="waitx.circuit.svg" width="560" height="290" class="svgscaleinsert mediacenter" alt="a2a:waitx.circuit.svg">  </td>
	</tr>
	<tr class="row1">
		<td class="col0 centeralign">  WAITX implementation<br/>
<span class="wrap_download "><a href="waitx.circuit.work" class="media mediafile mf_work" title="a2a:waitx.circuit.work (6.1 KB)">waitx.circuit.work</a> (6 KiB)</span>  </td>
	</tr>
</table></div>
</div>
<p>
WAITX isolates the outputs both from the metastability associated with non-persistent inputs, as well as from the metastability associated with making the decision of which input signal arrives first. The implementation relies on RWAIT elements for synchronisation with non-persistent signals, and uses a MUTEX element to make the decision on their arrival order. See <a href="#refnotes:1:note4" name="refnotes:1:ref6" class="refnotes-ref note-popup">[4]</a> for further implementation details and for a generalisation to more than 2 input signals.
</p>

</div>

<h3 id="waitx2">WAITX2</h3>
<div class="level3">

<p>
WAITX2 behaves as WAITX in the rising phase and as WAIT0 in the falling phase, i.e. it does not release the output asynchronous handshake until the winning input signal goes low. It uses a 2-phase output handshake similarly to WAIT2, and the specification, is therefore a combination of the STGs for WAITX and WAIT2.
</p>

<p>
The implementation comprises WAITX and two WAIT0 elements controlled by toggle-like asynchronous logic, which activates the right WAIT0 element in the reset phase. The synthesis and technology mapping of the control was performed using conventional asynchronous design approaches automated in Workcraft.
</p>
<div class="group plugin_wrap"><div class="wrap_column wrap_half plugin_wrap"><div class="wrap_column wrap_half plugin_wrap"><div class="table sectionedit96"><table class="inline">
	<tr class="row0">
		<td class="col0 rightalign">  <img src="waitx2-box.circuit.svg" width="126" height="261" class="svgscaleinsert mediacenter" alt="a2a:waitx2-box.circuit.svg"> </td>
	</tr>
	<tr class="row1">
		<td class="col0 centeralign">  WAITX2 block diagram<br/>
<span class="wrap_download "><a href="waitx2-box.circuit.work" class="media mediafile mf_work" title="a2a:waitx2-box.circuit.work (2.1 KB)">waitx2-box.circuit.work</a> (2 KiB)</span>  </td>
	</tr>
</table></div>
</div><div class="wrap_column wrap_half plugin_wrap"><div class="table sectionedit99"><table class="inline">
	<tr class="row0">
		<td class="col0"> <img src="waitx2.stg.svg" width="193" height="259" class="svgscaleinsert mediacenter" alt="a2a:waitx2.stg.svg"> </td>
	</tr>
	<tr class="row1">
		<td class="col0 centeralign">  WAITX2 specification<br/>
<span class="wrap_download "><a href="waitx2.stg.work" class="media mediafile mf_work" title="a2a:waitx2.stg.work (4.2 KB)">waitx2.stg.work</a> (4 KiB)</span>  </td>
	</tr>
</table></div>
</div></div><div class="wrap_column wrap_half plugin_wrap"><div class="table sectionedit102"><table class="inline">
	<tr class="row0">
		<td class="col0 leftalign"> <img src="waitx2.circuit.svg" width="318" height="266" class="svgscaleinsert mediacenter" alt="a2a:waitx2.circuit.svg">  </td>
	</tr>
	<tr class="row1">
		<td class="col0 centeralign">  WAITX2 implementation<br/>
<span class="wrap_download "><a href="waitx2.circuit.work" class="media mediafile mf_work" title="a2a:waitx2.circuit.work (5.3 KB)">waitx2.circuit.work</a> (5 KiB)</span>  </td>
	</tr>
</table></div>
</div></div>
</div>

<h3 id="sample">SAMPLE</h3>
<div class="level3">

<p>
The purpose of the SAMPLE element is to check whether the voltage on the input <code><span style='color:red; '>sig</span></code> is above the threshold. The specification is similar to that of WAITX but the two dummy transitions are controlled by conditions corresponding to the state of the same input <code><span style='color:red; '>sig</span></code>. The implementation is based on WAITX that decides which of the two inputs, <code><span style='color:red; '>sig</span></code> or its inverted version, becomes high first. Note that both inputs of WAITX may be high at the same time, e.g. during a transition of <code><span style='color:red; '>sig</span></code>, in which case SAMPLE is allowed to make an arbitrary decision. However, if the input signal is stable, no metastability resolution is required and SAMPLE can therefore quickly produce the correct output.
</p>
<div class="group plugin_wrap"><div class="wrap_column wrap_third plugin_wrap"><div class="table sectionedit107"><table class="inline">
	<tr class="row0">
		<td class="col0 centeralign">  <img src="sample-box.circuit.svg" width="139" height="161" class="svgscaleinsert mediacenter" alt="a2a:sample-box.circuit.svg">  </td>
	</tr>
	<tr class="row1">
		<td class="col0 centeralign">  SAMPLE block diagram<br/>
<span class="wrap_download "><a href="sample-box.circuit.work" class="media mediafile mf_work" title="a2a:sample-box.circuit.work (2 KB)">sample-box.circuit.work</a> (2 KiB)</span>  </td>
	</tr>
</table></div>
</div><div class="wrap_column wrap_third plugin_wrap"><div class="table sectionedit110"><table class="inline">
	<tr class="row0">
		<td class="col0 centeralign">  <img src="sample.stg.svg" width="266" height="160" class="svgscaleinsert mediacenter" alt="a2a:sample.stg.svg">  </td>
	</tr>
	<tr class="row1">
		<td class="col0 centeralign">  SAMPLE specification<br/>
<span class="wrap_download "><a href="sample.stg.work" class="media mediafile mf_work" title="a2a:sample.stg.work (3.6 KB)">sample.stg.work</a> (4 KiB)</span>  </td>
	</tr>
</table></div>
</div><div class="wrap_column wrap_third plugin_wrap"><div class="table sectionedit113"><table class="inline">
	<tr class="row0">
		<td class="col0 centeralign">  <img src="sample.circuit.svg" width="266" height="166" class="svgscaleinsert mediacenter" alt="a2a:sample.circuit.svg">  </td>
	</tr>
	<tr class="row1">
		<td class="col0 centeralign">  SAMPLE specification<br/>
<span class="wrap_download "><a href="sample.circuit.work" class="media mediafile mf_work" title="a2a:sample.circuit.work (3 KB)">sample.circuit.work</a> (3 KiB)</span>  </td>
	</tr>
</table></div>
</div></div>
</div>

<h3 id="opportunistic_merge">Opportunistic Merge</h3>
<div class="level3">

<p>
The opportunistic merge OM element merges two request-acknowledgement channels <code>{<span style='color:red; '>r1</span> / <span style='color:blue; '>a1</span>, <span style='color:red; '>r2</span> / <span style='color:blue; '>a2</span>}</code> into one <code><span style='color:blue; '>r</span> / <span style='color:red; '>a</span></code> and can opportunistically bundle requests from different input channels if they arrive sufficiently close to each other.
</p>

<p>
The conceptual state graphs clarifies the difference between the standard merge element <a href="#refnotes:1:note5" name="refnotes:1:ref7" class="refnotes-ref note-popup">[5]</a> and OM. The conceptual state graph of the merge element is shown on the left. Note that the bottom state of the graph is not persistent: outputs a1 and a2 disable each other, hence this is a decision-making element. The state graph for OM, shown on the right, has an additional <em>opportunistic bundle</em> transition labelled by <code>{<span style='color:blue; '>a1</span>, <span style='color:blue; '>a2</span>}</code> that sends acknowledgements to both input channels.
</p>
<div class="group plugin_wrap"><div class="wrap_column wrap_third plugin_wrap"><div class="table sectionedit118"><table class="inline">
	<tr class="row0">
		<td class="col0 centeralign">  <img src="om-box.circuit.svg" width="114" height="181" class="svgscaleinsert mediacenter" alt="a2a:om-box.circuit.svg">  </td>
	</tr>
	<tr class="row1">
		<td class="col0 centeralign">  OM block diagram<br/>
<span class="wrap_download "><a href="om-box.circuit.work" class="media mediafile mf_work" title="a2a:om-box.circuit.work (2.1 KB)">om-box.circuit.work</a> (2 KiB)</span>  </td>
	</tr>
</table></div>
</div><div class="wrap_column wrap_third plugin_wrap"><div class="table sectionedit121"><table class="inline">
	<tr class="row0">
		<td class="col0 centeralign">  <img src="merge.sg.svg" width="200" height="193" class="svgscaleinsert mediacenter" alt="a2a:merge.sg.svg">  </td>
	</tr>
	<tr class="row1">
		<td class="col0 centeralign">  MERGE specification (conceptual)  </td>
	</tr>
</table></div>
</div><div class="wrap_column wrap_third plugin_wrap"><div class="table sectionedit124"><table class="inline">
	<tr class="row0">
		<td class="col0 centeralign">  <img src="om.sg.svg" width="188" height="193" class="svgscaleinsert mediacenter" alt="a2a:om.sg.svg">  </td>
	</tr>
	<tr class="row1">
		<td class="col0 centeralign">  OM specification (conceptual)  </td>
	</tr>
</table></div>
</div></div><div class="wrap_center plugin_wrap"><div class="table sectionedit127"><table class="inline">
	<tr class="row0">
		<td class="col0"><img src="om.circuit.svg" width="323" height="174" class="svgscaleinsert mediacenter" alt="a2a:om.circuit.svg"></td>
	</tr>
	<tr class="row1">
		<td class="col0 centeralign">  OM implementation<br/>
<span class="wrap_download "><a href="om.circuit.work" class="media mediafile mf_work" title="a2a:om.circuit.work (4.8 KB)">om.circuit.work</a> (5 KiB)</span>  </td>
	</tr>
</table></div>
</div>
<p>
The intended application of OM is to handle concurrent (and potentially correlated) requests from several clients to a kind of service that benefits all the clients simultaneously. Examples include triggering an alarm by (any of) several sensors, re-charging of a shared DRAM, and various kinds of power management. All these use cases benefit from serving multiple requests in bundles. The <abbr title="Signal Transition Graph">STG</abbr> specification of OM, as well as further implementation details can be found in <a href="#refnotes:1:note6" name="refnotes:1:ref8" class="refnotes-ref note-popup">[6]</a>.
</p>

<p>
The input channels of OM are assumed to be hazard-free, but one can use the synchronisation primitives to generate clean hazard-free handshakes from hazardous input signals, e.g. produced by analogue sensors.
</p>













</div>
<div class="refnotes">
<hr>
<div class="notes">
<div class="note left">
<b><a name="refnotes:1:note1" class="nolink">[1]</a></b>
<span id="refnotes:1:note1:text">
D. Kinniment: “Synchronization and Arbitration in Digital Systems”, Wiley Publishing, 2008.
</span></div>
<div class="note left">
<b><a name="refnotes:1:note2" class="nolink">[2]</a></b>
<span id="refnotes:1:note2:text">
V. Khomenko, M. Schaefer and W. Vogler: “Output-Determinacy and Asynchronous Circuit Synthesis”, IOS Press, Fundamenta Informaticae 88(4) (2008) 541-579. Special Issue on Best Papers from ACSD&#039;2007.
</span></div>
<div class="note left">
<b><a name="refnotes:1:note3" class="nolink">[3]</a></b>
<span id="refnotes:1:note3:text">
A. Yakovlev, M. Kishinevsky, A. Kondratyev, L. Lavagno, M. Pietkiewicz-Koutny: “On the models for asynchronous circuit behaviour with OR causality”, Formal Methods in System Design, vol. 9(3), pp. 189–233, 1996.
</span></div>
<div class="note left">
<b><a name="refnotes:1:note4" class="nolink">[4]</a></b>
<span id="refnotes:1:note4:text">
V. Khomenko, D. Sokolov, A. Mokhov, A. Yakovlev: “WAITX: an arbiter for non-persistent signals”, Proc. Asynchronous Circuits and Systems (ASYNC), 2017.
</span></div>
<div class="note left">
<b><a name="refnotes:1:note5" class="nolink">[5]</a></b>
<span id="refnotes:1:note5:text">
M. Greenstreet: “Real-time merging”, Proc. Asynchronous Circuits and Systems (ASYNC), pp. 186–198, 1999.
</span></div>
<div class="note left">
<b><a name="refnotes:1:note6" class="nolink">[6]</a></b>
<span id="refnotes:1:note6:text">
A. Mokhov, V. Khomenko, D. Sokolov, A. Yakovlev: “Opportunistic merge element”, Proc. Asynchronous Circuits and Systems (ASYNC), pp. 116–123, 2015.
</span></div>
</div>
</div>
</div>

                    <!-- wikipage stop -->
                                    </div>
<!--
                                    <div class="docInfo"><bdi>help/a2a/start.txt</bdi> · Last modified: 2019/07/30 14:32 by <bdi>danil</bdi></div>
                -->

                            </div></div><!-- /content -->

            <hr class="a11y" />

            <!-- PAGE ACTIONS -->
<!--
            <div id="dokuwiki__pagetools">
                            <h3 class="a11y">Page Tools</h3>
                <div class="tools">
                    <ul>
                        <li><a href="start.html"  class="action edit" accesskey="e" rel="nofollow" title="Edit this page [E]"><span>Edit this page</span></a></li><li><a href="start.html"  class="action revs" accesskey="o" rel="nofollow" title="Old revisions [O]"><span>Old revisions</span></a></li><li><a href="start.html"  class="action backlink" rel="nofollow" title="Backlinks"><span>Backlinks</span></a></li><li><a href="start.html"  class="action export_pdf" rel="nofollow" title="Export to PDF"><span>Export to PDF</span></a></li><li class="plugin_move_page"><a href="start.html"><span>Rename Page</span></a></li><li><a href="#dokuwiki__top"  class="action top" accesskey="t" rel="nofollow" title="Back to top [T]"><span>Back to top</span></a></li><li><a href="start.html"  class="action siteexport_addpage" title="Export Page (Siteexport)"><span>Export Page</span></a></li><li><a href="javascript:void(0);" class="fold_unfold_all" onclick="fold_unfold_all();" rel="nofollow" title="Fold/unfold all"><span>Fold/unfold all</span></a></li><li><a href="start.html"  class="action siteexport_mapid" title="Show Map-ID"" data-mapid="start" onclick="copyMapIDToClipBoard.call(this); return false;"><span>Copy Map-ID: <span class="mapID" data-done="Done.">start</span></span></a></li>                    </ul>
                </div>
                        </div>
-->
        </div><!-- /wrapper -->

        
<!-- ********** FOOTER ********** -->
<div id="dokuwiki__footer"><div class="pad">
<!--
    
    <div class="buttons">
                <a href="http://www.dokuwiki.org/donate" title="Donate" ><img
            src="../lib/tpl/dokuwiki-light-export/images/button-donate.gif" width="80" height="15" alt="Donate" /></a>
        <a href="http://php.net" title="Powered by PHP" ><img
            src="../lib/tpl/dokuwiki-light-export/images/button-php.gif" width="80" height="15" alt="Powered by PHP" /></a>
        <a href="http://validator.w3.org/check/referer" title="Valid HTML5" ><img
            src="../lib/tpl/dokuwiki-light-export/images/button-html5.png" width="80" height="15" alt="Valid HTML5" /></a>
        <a href="http://jigsaw.w3.org/css-validator/check/referer?profile=css3" title="Valid CSS" ><img
            src="../lib/tpl/dokuwiki-light-export/images/button-css.png" width="80" height="15" alt="Valid CSS" /></a>
        <a href="http://dokuwiki.org/" title="Driven by DokuWiki" ><img
            src="../lib/tpl/dokuwiki-light-export/images/button-dw.png" width="80" height="15" alt="Driven by DokuWiki" /></a>
    </div>
    <div class="userInfo">
        Logged in as: workcraft    </div>
-->
</div></div><!-- /footer -->

    </div></div><!-- /site -->

    <div class="no"><img  width="2" height="1" alt="" /></div>
    <div id="screen__mode" class="no"></div></body>
</html>
