<!DOCTYPE html>
<html lang="en" dir="ltr" class="no-js">
<head>
    <meta charset="utf-8" />
    <title>tutorial:synthesis:celement:start - Workcraft</title>
    <script>(function(H){H.className=H.className.replace(/\bno-js\b/,'js')})(document.documentElement)</script>
    <meta name="generator" content="DokuWiki"/>
<meta name="robots" content="index,follow"/>
<meta name="keywords" content="tutorial,synthesis,celement,start"/>
<link rel="search" type="application/opensearchdescription+xml" href="../../lib/exe/opensearch.html" title="Workcraft"/>
<link rel="start" href="start.html"/>
<link rel="contents" href="start.html" title="Sitemap"/>
<link rel="alternate" type="application/rss+xml" title="Changes" />
<link rel="alternate" type="application/rss+xml" title="Current namespace" />
<link rel="edit" title="Edit this page" href="start.html"/>
<link rel="alternate" type="text/html" title="Plain HTML" href="../../_export/xhtml/tutorial/synthesis/celement/start.xhtml"/>
<link rel="alternate" type="text/plain" title="Wiki Markup" href="../../_export/raw/tutorial/synthesis/celement/start.raw"/>
<link rel="canonical" href="https://www.workcraft.org/tutorial/synthesis/celement/start"/>
<link rel="stylesheet" type="text/css" href="../../lib/exe/css.php.t.dokuwiki-light-export.css"/>
<!--[if gte IE 9]><!-->
<script type="text/javascript">/*<![CDATA[*/var NS='tutorial:synthesis:celement';var SIG=' --- //[[danilovesky@gmail.com|Danil Sokolov]] 2017/06/30 12:04//';var JSINFO = {"id":"tutorial:synthesis:celement:start","namespace":"tutorial:synthesis:celement","fastwiki":{"secedit":1,"preview":1,"fastpages":1,"save":0,"fastshow":0,"fastshow_same_ns":1,"fastshow_include":"","fastshow_exclude":"","preload":false,"preload_head":"====47hsjwycv782nwncv8b920m8bv72jmdm3929bno3b3====","preload_batchsize":false,"preload_per_page":false,"locktime":840,"usedraft":1,"text_btn_show":"Show page","templatename":"dokuwiki-light-export"},"move_renameokay":true,"plugin_folded":{"hide":"hide","reveal":"reveal"}};
/*!]]>*/</script>
<script type="text/javascript" charset="utf-8" src="../../lib/exe/jquery.php.t.dokuwiki-light-export.js"></script>
<script type="text/javascript" charset="utf-8" src="../../lib/exe/js.php.t.dokuwiki-light-export.js"></script>
<!--<![endif]-->
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <link rel="shortcut icon" href="../../favicon.ico" />
<link rel="apple-touch-icon" href="../../apple-touch-icon.png" />
    </head>

<body>
    <div id="dokuwiki__site"><div id="dokuwiki__top" class="site dokuwiki mode_show tpl_dokuwiki-light-export loggedIn    ">

        
<!-- ********** HEADER ********** -->
<div id="dokuwiki__header"><div class="pad group">

        <h1><a href="../../start.html"  title="Workcraft start page"><img src="../../logo.png" width="327" height="57" alt="" /></a></h1>
    
    <div class="tools group">
        <!-- USER TOOLS -->
<!--
                    <div id="dokuwiki__usertools">
                <h3 class="a11y">User Tools</h3>
                <ul>
                    <li><a href="start.html"  class="action admin" rel="nofollow" title="Admin">Admin</a></li><li><a href="start.html"  class="action profile" rel="nofollow" title="Profile">Profile</a></li><li><a href="start.html"  class="action logout" rel="nofollow" title="Log Out">Log Out</a></li>                </ul>
            </div>
        -->

        <!-- SEARCH TOOLS -->
<!--
        <div id="dokuwiki__searchtools">
            <h3 class="a11y"></h3>
            <form action="../../start.html" accept-charset="utf-8" class="search" id="dw__search" method="get" role="search"><div class="no"><input type="hidden" name="do" value="search" /><input type="text" placeholder="Search" id="qsearch__in" accesskey="f" name="id" class="edit" title="[F]" /><button type="submit" title="Search">Search</button><div id="qsearch__out" class="ajax_qsearch JSpopup"></div></div></form>        </div>
-->

        <!-- SITE TOOLS -->
<!--
        <div id="dokuwiki__sitetools">
            <h3 class="a11y">Site Tools</h3>
                            <div class="mobileTools">
                    <form action="../..//doku.html.doku.php.html" method="get" accept-charset="utf-8"><div class="no"><input type="hidden" name="id" value="tutorial:synthesis:celement:start" /><input type="hidden" name="sectok" value="b215501f07a481810e153f1a321e740e" /><select name="do" class="edit quickselect" title="Tools"><option value="">Tools</option><optgroup label="Page Tools"><option value="edit">Edit this page</option><option value="revisions">Old revisions</option><option value="backlink">Backlinks</option></optgroup><optgroup label="Site Tools"><option value="recent">Changes</option><option value="media">Manager</option><option value="index">Sitemap</option></optgroup><optgroup label="User Tools"><option value="logout">Log Out</option><option value="profile">Profile</option><option value="admin">Admin</option></optgroup></select><button type="submit">&gt;</button></div></form>                </div>
                <ul>
                    <li><a href="start.html"  class="action recent" accesskey="r" rel="nofollow" title="Changes [R]">Changes</a></li><li><a href="start.html"  class="action media" rel="nofollow" title="Manager">Manager</a></li><li><a href="start.html"  class="action index" accesskey="x" rel="nofollow" title="Sitemap [X]">Sitemap</a></li>                </ul>
                    </div>
-->
    </div>

    <!-- BREADCRUMBS -->
<!--
    -->



    <hr class="a11y" />
</div></div><!-- /header -->

        <div class="wrapper group">

            
            <!-- ********** CONTENT ********** -->
            <div id="dokuwiki__content"><div class="pad group">
                
                <div class="pageId"><span>tutorial:synthesis:celement:start</span></div>

                <div class="page group">
                                                            <!-- wikipage start -->
                    <div class="plugin_fastwiki_marker" style="display:none"></div><!-- TOC START -->
<div id="dw__toc">
<h3 class="toggle">Table of Contents</h3>
<div>

<ul class="toc">
<li class="level1"><div class="li"><a href="#modelling">Modelling</a></div></li>
<li class="level1"><div class="li"><a href="#validation_and_verification_of_specification">Validation and verification of specification</a></div></li>
<li class="level1"><div class="li"><a href="#synthesis">Synthesis</a></div></li>
<li class="level1"><div class="li"><a href="#circuit_capturing">Circuit capturing</a></div></li>
<li class="level1"><div class="li"><a href="#verification_of_implementation">Verification of implementation</a></div></li>
<li class="level1"><div class="li"><a href="#decomposed_implementation">Decomposed implementation</a></div></li>
<li class="level1"><div class="li"><a href="#solutions">Solutions</a></div></li>
</ul>
</div>
</div>
<!-- TOC END -->

<h1 id="synthesis_and_verification_of_c-element">Synthesis and verification of C-element</h1>
<div class="level1">

<p>
<a href="https://en.wikipedia.org/wiki/C-element" class="interwiki iw_wp" title="https://en.wikipedia.org/wiki/C-element">C-element</a> is a latch that synchronises the phases of its inputs. A symbol for a 2-input C-element and its timing diagram are shown in the figures below. Initially all the signals are in the low state. When both inputs <code>in1</code> and <code>in2</code> go high, the output <code>out</code> also switches to logical 1. It stays in this state until both inputs go low, at which stage the output switches to logical 0.
</p>
<div class="plugin_wrap"><div class="wrap_column plugin_wrap" style="width: 30%;">
<p>
<img src="schematic-celement.svg" width="116" height="29" class="svgscaleinsert mediacenter" alt="">
</p>
</div><div class="wrap_column plugin_wrap" style="width: 40%;">
<p>
<img src="td-celement.svg" width="196" height="78" class="svgscaleinsert mediacenter" alt="">
</p>
</div>
<p>
<br/>
<br/>

</p>
</div>
<p>
 <br/>

 <br/>

</p>

<p>
Note that the output of C-element is not fully determined by its inputs: When the inputs have different values the output keeps its previous value, i.e. it can be either 0 or 1. That is, C-element is not a combinational gate, but a latch with internal memory.
</p>

</div>

<h2 id="modelling">Modelling</h2>
<div class="level2">

<p>
Let us model the C-element behaviour using the <em>Signal Transition Graph (<abbr title="Signal Transition Graph">STG</abbr>)</em> formalism. Create a new <abbr title="Signal Transition Graph">STG</abbr> work called <em>stg-celement</em> and translate the sequence of events in the timing diagram into a sequence of <abbr title="Signal Transition Graph">STG</abbr> transitions. Basically you need to create a signal transition for each event of the timing diagram and capture the causality between these events by means of directed arcs between signal transitions. Recreate the following <abbr title="Signal Transition Graph">STG</abbr> model in Workcraft. 
</p>
<p><a class="folder" href="#folded_1">Detailed instructions </a></p><div class="folded hidden" id="folded_1">
<p>
Start with the reset phase of the C-element where <code>out-</code> event is caused by <code>in1-</code> and <code>in2-</code> events:
</p>
<ul>
<li class="level"><div class="li">
 Activate the <strong>signal transition generator</strong> <img src="../../help/editor_tools-signal_transition.png" class="media" title="[T] Signal Transition" alt="[T] Signal Transition" />. Pay attention to the hint at the bottom of the screen: <em>Click to create a falling (or rising with <kbd class="__keyboard">Ctrl</kbd>) transition of an output (or input with <kbd class="__keyboard">Shift</kbd>) signal</em>.
</div></li>
<li class="level"><div class="li">
 Click the Editor panel in the location where you want the <code>out-</code> transition to appear.
</div></li>
<li class="level"><div class="li">
 Hold <kbd class="__keyboard">Shift</kbd> and click in the desired location of <code>in1-</code> transition. The default name for the input signal is <code>in</code>, therefore you need to rename it. Activate the <strong>selection tool</strong> <img src="../../help/editor_tools-select.png" class="media" title="[S] Select" alt="[S] Select" /> and click on the transition and in the Property editor change its <em>Name</em> from <code>in</code> to <code>in1</code>. Alternatively, double-click on the transition and change its name directly in the Editor.
</div></li>
<li class="level"><div class="li">
 Create <code>in2-</code> transition the same way as <code>in1-</code>.
</div></li>
<li class="level"><div class="li">
 Activate <strong>connection tool</strong> <img src="../../help/editor_tools-connect.png" class="media" title="[C] Connect" alt="[C] Connect" />. Pay attention to the hints at the bottom of the screen. Initially the hint says <em>Click on the first component.</em> After the first component is chosen, the hint changes to <em>Click on the second component or create a node point. Hold <kbd class="__keyboard">Ctrl</kbd> to connect continuously</em>.
</div></li>
<li class="level"><div class="li">
 Click <code>in1-</code>, move the mouse pointer to the <code>out-</code> transition and click again. A causality arc from <code>in1-</code> to <code>out-</code> will be created.
</div></li>
<li class="level"><div class="li">
 Repeat the connection procedure to capture causality between <code>in2-</code> and <code>out-</code> transitions.
</div></li>
</ul>


<p>
<img src="stg-celement-step1.svg" width="98" height="89" class="svgscaleinsert mediacenter" alt="">
</p>

<p>
Similarly capture the set phase of the C-element:
</p>
<ul>
<li class="level"><div class="li">
 Create transitions <code>in1+</code>, <code>in2+</code> and <code>out+</code>. As before, rename the default <code>in</code> signal to <code>in1</code> and <code>in2</code> respectively.
</div></li>
<li class="level"><div class="li">
 Create causality arcs from <code>in1+</code> to <code>out+</code> and from <code>in2+</code> to <code>out+</code>.
</div></li>
<li class="level"><div class="li">
 Use the <strong>selection tool</strong> <img src="../../help/editor_tools-select.png" class="media" title="[S] Select" alt="[S] Select" /> to rearrange the <abbr title="Signal Transition Graph">STG</abbr> nodes similar to the following figure.
</div></li>
</ul>


<p>
<img src="stg-celement-step2.svg" width="239" height="89" class="svgscaleinsert mediacenter" alt="">
</p>

<p>
Now connect the set and reset portions of the specification:
</p>
<ul>
<li class="level"><div class="li">
 The same as before, use <strong>connection tool</strong> <img src="../../help/editor_tools-connect.png" class="media" title="[C] Connect" alt="[C] Connect" /> to introduce causality from <code>out+</code> to <code>in1-</code> and to <code>in2-</code>.
</div></li>
<li class="level"><div class="li">
 Create an arc from <code>out-</code> to <code>in1+</code>, but this time instead of a straight line connection use a polyline. After choosing the source of the connection (<code>out-</code> transition) click aside of the existing transitions - this will create a node point of a polyline. Continue forming the shape of the polyline by creating its node points, and finally choose the destination transition <code>in1+</code>.
</div></li>
<li class="level"><div class="li">
 Repeat the same procedure for creating a polyline connection from <code>out-</code> to <code>in2+</code>.
</div></li>
</ul>


<p>
<img src="stg-celement-step3.svg" width="239" height="116" class="svgscaleinsert mediacenter" alt="">
</p>

<p>
Finally, specify the initial state of the C-element in accordance to the starting point of the timing diagram:
</p>
<ul>
<li class="level"><div class="li">
 Activate the <strong>selection tool</strong> <img src="../../help/editor_tools-select.png" class="media" title="[S] Select" alt="[S] Select" />.
</div></li>
<li class="level"><div class="li">
 Select the arc from <code>out-</code> to <code>in1+</code> and in the Property editor set the <em>Tokens</em> value to 1. Alternatively, hold <kbd class="__keyboard">Ctrl</kbd> and double-click this arc.
</div></li>
<li class="level"><div class="li">
 Similarly put a token on the arc from <code>out-</code> to <code>in2+</code>.
</div></li>
</ul>

</div>
<p>
The resulting <abbr title="Signal Transition Graph">STG</abbr> should look as follows.
</p>

<p>
<img src="stg-celement.svg" width="239" height="116" class="svgscaleinsert mediacenter" alt="C-element STG model">
</p>

</div>

<h2 id="validation_and_verification_of_specification">Validation and verification of specification</h2>
<div class="level2">

<p>
Activate the <strong>simulation tool</strong> <img src="../../help/editor_tools-simulate.png" class="media" title="[M] Simulate" alt="[M] Simulate" /> and exercise the obtained <abbr title="Signal Transition Graph">STG</abbr> model. Click one of the enabled signal transitions (they are highlighted in orange) to <em>fire</em> (or <em>execute</em>) it, which changes the <em>state</em> (or <em>marking</em>) of the <abbr title="Signal Transition Graph">STG</abbr>. Note that the sequence of fired transitions is recorded in the simulation trace that is somewhat similar to the original timing diagram. Check that the simulation traces correspond to the intended behaviour of C-element.
</p>

<p>
For example, simulate the following trace <code><span style='color:red; '>in2+</span>, <span style='color:red; '>in1+</span>, <span style='color:blue; '>out+</span>, <span style='color:red; '>in1-</span>, <span style='color:red; '>in2-</span>, <span style='color:blue; '>out-</span>, <span style='color:red; '>in1+</span>, <span style='color:red; '>in2+</span></code> – you can copy the trace to clipboard and paste it in simulation tool by pressing <img src="../../help/tool_controls-simulate-paste_trace.png" class="media" title="Paste from clipboard" alt="Paste from clipboard" />. Then use the generator of trace diagram <img src="../../help/tool_controls-simulate-generate_trace_diagram.png" class="media" title="Generate trace diagram" alt="Generate trace diagram" /> to convert the <abbr title="Signal Transition Graph">STG</abbr> simulation trace to <em>Digital Timing Diagram</em> model. The produced timing diagram should resemble the initial informal specification and looks as follows.
</p>

<p>
<img src="dtd-celement.svg" width="273" height="118" class="svgscaleinsert mediacenter" alt="C-element DTD model">
</p>
<div class="wrap_info wrap_center wrap_round plugin_wrap" style="width: 90%;">
<p>
The visibility and color of signals in the generated timing diagram are defined in <strong>Visible</strong> and <strong>Color</strong> columns of the signal state table, at the bottom of <strong>Tool controls</strong> for <abbr title="Signal Transition Graph">STG</abbr> simulation tool. The order of signal waveforms is also defined in this table by rearranging (drag-and-drop) the signal rows.
</p>

<p>
The timing diagram is built for the main simulation trace – <strong>Trace</strong> column. If the <strong>Trace</strong> is empty then the timing diagram generator will suggest to use <strong>Branch</strong> simulation results instead.
</p>
</div>
<p>
Before proceeding to the synthesis of the C-element it is a good idea to verify that its specification meets essential requirements, e.g. that it is consistent, free from deadlocks, input-proper and output-persistent. These properties can be checked via the <em>Verification</em> menu. Note that it is possible to check these properties either separately or jointly with a single click.
</p>

<p>
If the specification violates any of these properties then a trace leading to the problematic state will be reported. This trace can be simulated for better understanding the reported issues and for correcting them in the specification.
</p>

</div>

<h2 id="synthesis">Synthesis</h2>
<div class="level2">

<p>
The <abbr title="Signal Transition Graph">STG</abbr> specification can now be synthesised into an asynchronous circuit implementation either with MPSat or Petrify back-end tools via <em>Synthesis</em> menu.
</p>

<p>
A complex-gate implementation obtained with Petrify (<em>Synthesis→Complex gate [Petrify]</em> menu item) appears in the Output panel towards the end and is as follows: (<span class="wrap_important ">Note that you may get a slightly different equation.</span>)
</p>
<pre class="code">[out] = in2 (in1 + out) + in1 out;</pre>

<p>
By opening the parenthesis one can re-write it as
</p>
<pre class="code">[out] = in1 in2 + in2 out + in1 out;</pre>

<p>
This equation can be directly mapped into an AND-OR complex gate whose function is <code>Z = A*B + C*D + E*F</code> ; let us call it <em>AO222</em> gate. 
</p>
<div class="wrap_center wrap_round wrap_info plugin_wrap" style="width: 90%;">
<p>
Circuit designers use hardware description languages, such as <a href="https://en.wikipedia.org/wiki/Verilog" class="interwiki iw_wp" title="https://en.wikipedia.org/wiki/Verilog">Verilog</a> or <a href="https://en.wikipedia.org/wiki/VHDL" class="interwiki iw_wp" title="https://en.wikipedia.org/wiki/VHDL">VHDL</a>, to precisely describe the circuit. For example, the association of the C-element ports to the <em>AO222</em> gate pins can be described by the following Verilog module (if you are not familiar with Verilog you can safely skip this part as it is not required by the rest of the tutorial):
</p>
<pre class="code verilog"><span class="kw1">module</span> celement <span class="br0">&#40;</span>in1<span class="sy0">,</span> in2<span class="sy0">,</span> out<span class="br0">&#41;</span><span class="sy0">;</span>
  <span class="kw1">input</span> in1<span class="sy0">;</span>
  <span class="kw1">input</span> in2<span class="sy0">;</span>
  <span class="kw1">output</span> out<span class="sy0">;</span>
  AO222 inst_c <span class="br0">&#40;</span>.A<span class="br0">&#40;</span>in1<span class="br0">&#41;</span><span class="sy0">,</span> .B<span class="br0">&#40;</span>in2<span class="br0">&#41;</span><span class="sy0">,</span> .C<span class="br0">&#40;</span>in2<span class="br0">&#41;</span><span class="sy0">,</span> .D<span class="br0">&#40;</span>out<span class="br0">&#41;</span><span class="sy0">,</span> .E<span class="br0">&#40;</span>in1<span class="br0">&#41;</span><span class="sy0">,</span> .F<span class="br0">&#40;</span>out<span class="br0">&#41;</span><span class="sy0">,</span> .Z<span class="br0">&#40;</span>out<span class="br0">&#41;</span><span class="br0">&#41;</span><span class="sy0">;</span>
<span class="kw1">endmodule</span></pre>
</div>
</div>

<h2 id="circuit_capturing">Circuit capturing</h2>
<div class="level2">
<div class="wrap_center wrap_round wrap_info plugin_wrap" style="width: 90%;">
<p>
Workcraft can automatically derive a circuit from the synthesis output of MPSat or Petrify. (This is controlled by the <em>Import synthesis result</em> checkbox the <em>Edit→Preferences…</em> window under the <em>Models→Digital Circuit</em> leaf, and is enabled by default.) However, for the purposes of this exercise you should capture the circuit schematics manually.
</p>
</div>
<p>
Create a new Digital Circuit work called <em>circuit-celement-cg</em> and capture the implementation suggested by Petrify in form of a gate-level netlist.
</p>
<ul>
<li class="level"><div class="li">
 Activate <strong>functional generator</strong> <img src="../../help/editor_tools-function.png" class="media" title="[F] Function" alt="[F] Function" /> and click in the desired position of the AND-OR complex gate.
</div></li>
<li class="level"><div class="li">
 Activate <strong>selection tool</strong> <img src="../../help/editor_tools-select.png" class="media" title="[S] Select" alt="[S] Select" />.
</div></li>
<li class="level"><div class="li">
 Select the only pin of the newly created function component.
</div></li>
<li class="level"><div class="li">
 In the Property editor change the <em>Name</em> of the pin to <code>Z</code> and modify its <em>Set function</em> to <code>A*B+C*D+E*F</code>.
</div></li>
</ul>


<p>
<img src="circuit-celement-cg-step2.svg" width="136" height="80" class="svgscaleinsert mediacenter" alt="">
</p>
<ul>
<li class="level"><div class="li">
 Activate <strong>port generator</strong> <img src="../../help/editor_tools-port.png" class="media" title="[P] Input/output port" alt="[P] Input/output port" />. Pay attention to the hint at the bottom of the screen: <em>Click to create an output port (hold Shift for input port)</em>.
</div></li>
<li class="level"><div class="li">
 Click in intended location of the output port. Note that by default the port will be named <code>out1</code> - you can change this name to <code>out</code> later. 
</div></li>
<li class="level"><div class="li">
 Hold <kbd class="__keyboard">Shift</kbd> and click in the desired locations of the input ports – they will be automatically assigned the names <code>in0</code> and <code>in1</code>.
</div></li>
<li class="level"><div class="li">
 Switch to the selection tool. Choose the output port, go to the property editor and change port <em>Name</em> to <code>out</code>. Similarly change the name of input port <code>in0</code> to <code>in2</code>.
</div></li>
</ul>


<p>
<img src="circuit-celement-cg-step3.svg" width="306" height="80" class="svgscaleinsert mediacenter" alt="">
</p>
<ul>
<li class="level"><div class="li">
 Activate <strong>connection tool</strong> <img src="../../help/editor_tools-connect.png" class="media" title="[C] Connect" alt="[C] Connect" />.
</div></li>
<li class="level"><div class="li">
 Connect input ports <code>in1</code> to the 1<sup>st</sup> and 5<sup>th</sup> pins of the complex gate (<code>A</code> and <code>E</code> respectively).
</div></li>
<li class="level"><div class="li">
 Connect input ports <code>in2</code> to the 2<sup>nd</sup> and 3<sup>rd</sup> pins of the complex gate (<code>B</code> and <code>C</code> respectively).
</div></li>
<li class="level"><div class="li">
 Connect the output pin of the gate to the output port <code>out</code> and to the 4<sup>th</sup> and 6<sup>th</sup> inputs of the gate (<code>D</code> and <code>F</code> respectively).
</div></li>
</ul>


<p>
<img src="circuit-celement-cg-step4.svg" width="306" height="115" class="svgscaleinsert mediacenter" alt="">
</p>
<div class="wrap_center wrap_round wrap_box plugin_wrap" style="width: 90%;">
<h4 id="optional_simplification">Optional simplification</h4>

<p>
You may wish to tidy up the circuit schematic and make it more readable by adding wire forks. If you create a connection to/from a wire then a <strong>joint</strong> will be automatically inserted. This result should look as follows; this implementation can be downloaded here: <span class="wrap_download "><a href="circuit-celement-cg.work" class="media mediafile mf_work" title="tutorial:synthesis:celement:circuit-celement-cg.work (3.1 KB)">circuit-celement-cg.work</a> (3.09 KiB)</span>.
</p>

<p>
<img src="circuit-celement-cg.svg" width="331" height="98" class="svgscaleinsert mediacenter" alt="">
</p>
</div>
</div>

<h2 id="verification_of_implementation">Verification of implementation</h2>
<div class="level2">

<p>
Activate the <strong>simulation tool</strong> <img src="../../help/editor_tools-simulate.png" class="media" title="[M] Simulate" alt="[M] Simulate" /> and simulate the captured complex gate implementation of the C-element. Ports, pins and wires are colour-coded: blue means low level and red means high level of the signal. Excited pins and ports are highlighted in orange. 
</p>

<p>
Click one of the excited pins to toggle its logical value. Similar to the <abbr title="Signal Transition Graph">STG</abbr> simulation, the sequence of signal events is recorded in the simulation trace and can be subsequently replayed for analysing the circuit&#039;s behaviour or converted to a timing diagram for visualisation purpose.
</p>

<p>
To conduct formal verification the circuit has to be converted into an <abbr title="Signal Transition Graph">STG</abbr>. Normally this is done silently by the tool, but it is possible to view the intermediate circuit-<abbr title="Signal Transition Graph">STG</abbr> via <em>Conversion→Signal Transition Graph</em>. The resulting <abbr title="Signal Transition Graph">STG</abbr> for this circuit is shown below. <span class="wrap_important ">Note that your layout may be slightly different and that this <abbr title="Signal Transition Graph">STG</abbr> will not be required in the rest of the tutorial.</span>
</p>

<p>
<img src="stg-celement-circuit_stg.svg" width="381" height="141" class="svgscaleinsert mediacenter" alt="">
</p>

<p>
Note that if the C-element&#039;s inputs are not restricted in any way then they can change in an unexpected manner and cause malfunction of the circuit. This can be confirmed by checking the circuit for output persistency <em>Verification→Output persistency [MPSat]</em> – output <code><span style='color:blue; '>out</span></code> exhibits non-persistent behaviour after the following trace: <code><span style='color:red; '>in2+</span>, <span style='color:red; '>in1+</span></code>. Play this trace to discover that indeed, at the end of it the output of the C-element is excited and ready to switch to logical 1, but an unexpected <code><span style='color:red; '>in1-</span></code> or <code><span style='color:red; '>in2-</span></code> transition would disable it, that does not fit the original <abbr title="Signal Transition Graph">STG</abbr> specification.
</p>
<div class="wrap_center wrap_round wrap_important plugin_wrap" style="width: 90%;">
<p>
The <abbr title="Signal Transition Graph">STG</abbr> specification contains some information that is not available in the circuit, namely the behaviour of the environment. The circuit is guaranteed to work correctly only in an environment that respects its contract specified by the original <abbr title="Signal Transition Graph">STG</abbr>. In other environments the circuit may exhibit non-persistency, deadlocks, etc. Therefore, during formal verification of the circuit one has to restrict its environment in such a way that the circuit only receives those inputs that are allowed by the <abbr title="Signal Transition Graph">STG</abbr> specification. 
</p>
</div>
<p>
This can be achieved as follows:
</p>
<ul>
<li class="level"><div class="li">
 In the circuit editor make sure that no components are selected (click on the editor canvas).
</div></li>
<li class="level"><div class="li">
 In the property editor choose the <em>Environment <abbr title="Uniform Resource Identifier">URI</abbr></em> property and select the work file with the original <abbr title="Signal Transition Graph">STG</abbr> specification.
</div></li>
</ul>


<p>
Repeat the verification procedure to check that assuming a well behaved environment the circuit is output persistent, deadlock-free and conforms to the environment specification. All these verification steps can be performed simultaneously via <em>Verification→Conformation, deadlock and output persistency (reuse unfolding) [MPSat]</em>.
</p>

</div>

<h2 id="decomposed_implementation">Decomposed implementation</h2>
<div class="level2">

<p>
Large gates like <code>AO222</code> may not be available in the technology library and thus other implementations of C-element using smaller gates are of interest. However, it is very easy to make a mistake when designing asynchronous circuits, and so any such implementation has to be formally verified against the original <abbr title="Signal Transition Graph">STG</abbr> specification. 
</p>

<p>
Download the following C-element implementation due to Mayevsky <span class="wrap_download "><a href="circuit-celement-decomposed.work" class="media mediafile mf_work" title="tutorial:synthesis:celement:circuit-celement-decomposed.work (3.8 KB)">circuit-celement-decomposed.work</a> (3.78 KiB)</span> and verify that it conforms to the <abbr title="Signal Transition Graph">STG</abbr> specification, is free from deadlocks, input-proper, and output persistent.
</p>

<p>
<img src="circuit-celement-decomposed.svg" width="437" height="141" class="svgscaleinsert mediacenter" alt="">
</p>

<p>
Note that the correctness of this implementation depends on the <em>isochronic forks assumption</em>: the difference in arrival times of a signal to the ends of a wire fork is negligible compared to any gate delay. If this assumption is violated, the above implementation can exhibit non-persistent behaviour. Download the following C-element implementation <span class="wrap_download "><a href="circuit-celement-decomposed-hazard.work" class="media mediafile mf_work" title="tutorial:synthesis:celement:circuit-celement-decomposed-hazard.work (4 KB)">circuit-celement-decomposed-hazard.work</a> (3.96 KiB)</span> where a delay in a wire fork is made explicit (modelled by a buffer). Formally verify this model, inspect the violation trace, and explain what can go wrong in it.
</p>

<p>
<img src="circuit-celement-decomposed-hazard.svg" width="437" height="141" class="svgscaleinsert mediacenter" alt="">
</p>

</div>

<h2 id="solutions">Solutions</h2>
<div class="level2">

<p>
Download all the Workcraft models discussed in this tutorial here:
</p>

<p>
<span class="wrap_download "><a href="celement.zip" class="media mediafile mf_zip" title="tutorial:synthesis:celement:celement.zip (13.8 KB)">C-element models</a> (13.83 KiB)</span>
</p>

</div>
<div class="level1">
<div class="plugin_include_content plugin_include__tutorial:feedback" id="plugin_include__tutorial__feedback">
<div class="wrap_hide plugin_wrap"><pre class="code">===== Feedback =====</pre>
<form class="bureaucracy__plugin" id="bureaucracy__plugin1" enctype="multipart/form-data" method="post" action="start.html" accept-charset="utf-8"><div class="no">
<input type="hidden" name="sectok" value="b215501f07a481810e153f1a321e740e" /><input type="hidden" name="id" value="tutorial:synthesis:celement:start" /><input type="hidden" name="bureaucracy[$$id]" value="1" /><fieldset ><legend>Comments or suggestions for improving this tutorial</legend>
<label><span>Name (optional)</span> <input type="text" name="bureaucracy[1]" class="edit" /></label>
<label><span>Email (optional)</span> <input type="text" name="bureaucracy[2]" class="edit" /></label>
<label class=" textareafield">
    <span>Feedback <sup>*</sup></span>
    <textarea name="bureaucracy[3]" id="" rows="10" cols="10" class="edit required&quot; required=&quot;required"></textarea>
</label><button type="submit">Submit</button>
</fieldset>
</div></form>
</div><div class="wrap_hide plugin_wrap"><ul>
<li class="level"><div class="li">
 As discussed in <a href="https://www.dokuwiki.org/plugin:include#controlling_header_size_in_included_pages" class="urlextern" title="https://www.dokuwiki.org/plugin:include#controlling_header_size_in_included_pages" rel="nofollow">https://www.dokuwiki.org/plugin:include#controlling_header_size_in_included_pages</a>, by default, the headers in included pages start one level lower than the last header in the current page. This can be tweaked by adding an empty header above the include:\\<pre class="code">====== ======
{{page&gt;:tutorial:feedback&amp;inline}}</pre>

<p>

</div></li>
<li class="level"><div class="li">
 For offline help generation the content of <code>feedback</code> page should be temporary wrapped in <code>&lt;WRAP hide&gt;</code>. Note that the headers still propagate to the table of contents even if inside the hidden wrap. Therefore the <strong>Feedback</strong> title needs to be converted to something else, e.g. to code by adding two spaces in front.
</p>

</div></li>
</ul>

</div></div>

</div>

                    <!-- wikipage stop -->
                                    </div>
<!--
                                    <div class="docInfo"><bdi>tutorial/synthesis/celement/start.txt</bdi> · Last modified: 2017/03/06 14:54 (external edit)</div>
                -->

                            </div></div><!-- /content -->

            <hr class="a11y" />

            <!-- PAGE ACTIONS -->
<!--
            <div id="dokuwiki__pagetools">
                            <h3 class="a11y">Page Tools</h3>
                <div class="tools">
                    <ul>
                        <li><a href="start.html"  class="action edit" accesskey="e" rel="nofollow" title="Edit this page [E]"><span>Edit this page</span></a></li><li><a href="start.html"  class="action revs" accesskey="o" rel="nofollow" title="Old revisions [O]"><span>Old revisions</span></a></li><li><a href="start.html"  class="action backlink" rel="nofollow" title="Backlinks"><span>Backlinks</span></a></li><li class="plugin_move_page"><a href="start.html"><span>Rename Page</span></a></li><li><a href="#dokuwiki__top"  class="action top" accesskey="t" rel="nofollow" title="Back to top [T]"><span>Back to top</span></a></li><li><a href="javascript:void(0);" class="fold_unfold_all" onclick="fold_unfold_all();" rel="nofollow" title="Fold/unfold all"><span>Fold/unfold all</span></a></li><li><a href="start.html"  class="action siteexport_addpage" title="Add page"><span>Export Page</span></a></li>                    </ul>
                </div>
                        </div>
-->
        </div><!-- /wrapper -->

        
<!-- ********** FOOTER ********** -->
<div id="dokuwiki__footer"><div class="pad">
<!--
    
    <div class="buttons">
                <a href="http://www.dokuwiki.org/donate" title="Donate" ><img
            src="../../lib/tpl/dokuwiki-light-export/images/button-donate.gif" width="80" height="15" alt="Donate" /></a>
        <a href="http://php.net" title="Powered by PHP" ><img
            src="../../lib/tpl/dokuwiki-light-export/images/button-php.gif" width="80" height="15" alt="Powered by PHP" /></a>
        <a href="http://validator.w3.org/check/referer" title="Valid HTML5" ><img
            src="../../lib/tpl/dokuwiki-light-export/images/button-html5.png" width="80" height="15" alt="Valid HTML5" /></a>
        <a href="http://jigsaw.w3.org/css-validator/check/referer?profile=css3" title="Valid CSS" ><img
            src="../../lib/tpl/dokuwiki-light-export/images/button-css.png" width="80" height="15" alt="Valid CSS" /></a>
        <a href="http://dokuwiki.org/" title="Driven by DokuWiki" ><img
            src="../../lib/tpl/dokuwiki-light-export/images/button-dw.png" width="80" height="15" alt="Driven by DokuWiki" /></a>
    </div>
    <div class="userInfo">
        Logged in as:: danil    </div>
-->
</div></div><!-- /footer -->

    </div></div><!-- /site -->

    <div class="no"><img  width="2" height="1" alt="" /></div>
    <div id="screen__mode" class="no"></div></body>
</html>

